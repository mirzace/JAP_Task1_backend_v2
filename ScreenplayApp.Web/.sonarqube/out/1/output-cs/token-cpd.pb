ê1
ÉC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Data\DataContext.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Data' +
{ 
public 

class 
DataContext 
: 
IdentityDbContext 0
<0 1
AppUser1 8
,8 9
AppRole: A
,A B
intC F
,F G
IdentityUserClaim 
< 
int 
> 
, 
AppUserRole  +
,+ ,
IdentityUserLogin- >
<> ?
int? B
>B C
,C D
IdentityRoleClaim 
< 
int 
> 
, 
IdentityUserToken  1
<1 2
int2 5
>5 6
>6 7
{ 
public 
DataContext 
( 
DbContextOptions +
<+ ,
DataContext, 7
>7 8
options9 @
)@ A
:B C
baseD H
(H I
optionsI P
)P Q
{ 	
} 	
public 
DbSet 
< 

Screenplay 
>  
Screenplays! ,
{- .
get/ 2
;2 3
set4 7
;7 8
}9 :
public 
DbSet 
< 
Actor 
> 
Actors "
{# $
get% (
;( )
set* -
;- .
}/ 0
public 
DbSet 
< 
Rating 
> 
Ratings $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
Ticket 
> 
Tickets $
{% &
get' *
;* +
set, /
;/ 0
}1 2
public 
DbSet 
< 
Booking 
> 
Bookings &
{' (
get) ,
;, -
set. 1
;1 2
}3 4
public 
DbSet 
< !
MostRatedMoviesReport *
>* +"
MostRatedMoviesReports, B
{C D
getE H
;H I
setJ M
;M N
}O P
public 
DbSet 
< -
!MostSoldMoviesWithoutRatingReport 6
>6 7-
!MostSoldMoviesWithoutRatingReport8 Y
{Z [
get\ _
;_ `
seta d
;d e
}f g
public   
DbSet   
<   ,
 MostViewedMoviesForAPeriodReport   5
>  5 6,
 MostViewedMoviesForAPeriodReport  7 W
{  X Y
get  Z ]
;  ] ^
set  _ b
;  b c
}  d e
	protected"" 
override"" 
void"" 
OnModelCreating""  /
(""/ 0
ModelBuilder""0 <
builder""= D
)""D E
{## 	
base$$ 
.$$ 
OnModelCreating$$  
($$  !
builder$$! (
)$$( )
;$$) *
builder'' 
.'' 
Entity'' 
<'' 
AppUser'' "
>''" #
(''# $
)''$ %
.(( 
HasMany(( 
((( 
ur(( 
=>(( 
ur(( !
.((! "
	UserRoles((" +
)((+ ,
.)) 
WithOne)) 
()) 
u)) 
=>)) 
u)) 
.))  
User))  $
)))$ %
.** 
HasForeignKey** 
(** 
ur** !
=>**" $
ur**% '
.**' (
UserId**( .
)**. /
.++ 

IsRequired++ 
(++ 
)++ 
;++ 
builder-- 
.-- 
Entity-- 
<-- 
AppRole-- "
>--" #
(--# $
)--$ %
... 
HasMany.. 
(.. 
ur.. 
=>.. 
ur.. !
...! "
	UserRoles.." +
)..+ ,
.// 
WithOne// 
(// 
u// 
=>// 
u// 
.//  
Role//  $
)//$ %
.00 
HasForeignKey00 
(00 
ur00 !
=>00" $
ur00% '
.00' (
RoleId00( .
)00. /
.11 

IsRequired11 
(11 
)11 
;11 
var44 
screenplays44 
=44 
builder44 %
.44% &
Entity44& ,
<44, -

Screenplay44- 7
>447 8
(448 9
)449 :
;44: ;
screenplays66 
.77 
Property77 
(77 
e77 
=>77 
e77  
.77  !
Category77! )
)77) *
.88 
HasConversion88 
(88 
v99 
=>99 
v99 
.99 
ToString99 #
(99# $
)99$ %
,99% &
v:: 
=>:: 
(:: 
Category:: "
)::" #
Enum::# '
.::' (
Parse::( -
(::- .
typeof::. 4
(::4 5
Category::5 =
)::= >
,::> ?
v::@ A
)::A B
)::B C
;::C D
builder== 
.== 
Entity== 
<== !
MostRatedMoviesReport== 0
>==0 1
(==1 2
)==2 3
.==3 4
HasNoKey==4 <
(==< =
)=== >
;==> ?
builder>> 
.>> 
Entity>> 
<>> -
!MostSoldMoviesWithoutRatingReport>> <
>>>< =
(>>= >
)>>> ?
.>>? @
HasNoKey>>@ H
(>>H I
)>>I J
;>>J K
builder?? 
.?? 
Entity?? 
<?? ,
 MostViewedMoviesForAPeriodReport?? ;
>??; <
(??< =
)??= >
.??> ?
HasNoKey??? G
(??G H
)??H I
;??I J
}@@ 	
}AA 
}BB ≤<
ÅC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Data\Seed\Seed.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Data' +
.+ ,
Seed, 0
{ 
public 

class 
Seed 
{ 
public 
static 
async 
Task  
	SeedUsers! *
(* +
UserManager+ 6
<6 7
AppUser7 >
>> ?
userManager@ K
,K L
RoleManagerM X
<X Y
AppRoleY `
>` a
roleManagerb m
)m n
{ 	
if 
( 
await 
userManager !
.! "
Users" '
.' (
AnyAsync( 0
(0 1
)1 2
)2 3
return4 :
;: ;
var 
roles 
= 
new 
List  
<  !
AppRole! (
>( )
{ 
new 
AppRole 
{ 
Name "
=# $
AppRolesEnum% 1
.1 2
Consumer2 :
.: ;
ToString; C
(C D
)D E
}E F
,F G
new 
AppRole 
{ 
Name "
=# $
AppRolesEnum% 1
.1 2
Admin2 7
.7 8
ToString8 @
(@ A
)A B
}B C
} 
; 
foreach 
( 
var 
role 
in  
roles! &
)& '
{ 
await 
roleManager !
.! "
CreateAsync" -
(- .
role. 2
)2 3
;3 4
} 
var!! 
admin!! 
=!! 
new!! 
AppUser!! #
{"" 
UserName## 
=## 
$str## "
}$$ 
;$$ 
await&& 
userManager&& 
.&& 
CreateAsync&& )
(&&) *
admin&&* /
,&&/ 0
$str&&1 ;
)&&; <
;&&< =
await'' 
userManager'' 
.'' 
AddToRoleAsync'' ,
('', -
admin''- 2
,''2 3
AppRolesEnum''4 @
.''@ A
Admin''A F
.''F G
ToString''G O
(''O P
)''P Q
)''Q R
;''R S
var** 
user** 
=** 
new** 
AppUser** "
{++ 
UserName,, 
=,, 
$str,, !
}-- 
;-- 
await// 
userManager// 
.// 
CreateAsync// )
(//) *
user//* .
,//. /
$str//0 :
)//: ;
;//; <
await00 
userManager00 
.00 
AddToRoleAsync00 ,
(00, -
user00- 1
,001 2
AppRolesEnum003 ?
.00? @
Consumer00@ H
.00H I
ToString00I Q
(00Q R
)00R S
)00S T
;00T U
}11 	
public33 
static33 
async33 
Task33  
SeedScreenplays33! 0
(330 1
DataContext331 <
context33= D
)33D E
{44 	
if55 
(55 
await55 
context55 
.55 
Screenplays55 )
.55) *
AnyAsync55* 2
(552 3
)553 4
||555 7
await558 =
context55> E
.55E F
Ratings55F M
.55M N
AnyAsync55N V
(55V W
)55W X
)55X Y
return55Z `
;55` a
var77 
screenplayData77 
=77  
await77! &
System77' -
.77- .
IO77. 0
.770 1
File771 5
.775 6
ReadAllTextAsync776 F
(77F G
$str	77G ä
)
77ä ã
;
77ã å
var88 
screenplays88 
=88 
JsonSerializer88 ,
.88, -
Deserialize88- 8
<888 9
List889 =
<88= >

Screenplay88> H
>88H I
>88I J
(88J K
screenplayData88K Y
)88Y Z
;88Z [
foreach:: 
(:: 
var:: 

screenplay:: #
in::$ &
screenplays::' 2
)::2 3
{;; 
context<< 
.<< 
Screenplays<< #
.<<# $
Add<<$ '
(<<' (

screenplay<<( 2
)<<2 3
;<<3 4
}== 
await?? 
context?? 
.?? 
SaveChangesAsync?? *
(??* +
)??+ ,
;??, -
stringCC 
[CC 
]CC 
	locationsCC 
=CC  
{CC! "
$strCC# /
,CC/ 0
$strCC1 =
,CC= >
$strCC? K
,CCK L
$strCCM Y
,CCY Z
$strCC[ g
}CCh i
;CCi j
RandomDD 
randDD 
=DD 
newDD 
RandomDD $
(DD$ %
)DD% &
;DD& '
foreachFF 
(FF 

ScreenplayFF 

screenplayFF  *
inFF+ -
screenplaysFF. 9
)FF9 :
{GG 
forHH 
(HH 
intHH 
iHH 
=HH 
$numHH 
;HH 
iHH  !
<HH" #
$numHH$ %
;HH% &
iHH' (
++HH( *
)HH* +
{II 
intJJ 
indexJJ 
=JJ 
randJJ  $
.JJ$ %
NextJJ% )
(JJ) *
$numJJ* +
,JJ+ ,
$numJJ, -
)JJ- .
;JJ. /
ifLL 
(LL 

screenplayLL "
.LL" #
CategoryLL# +
.LL+ ,
ToStringLL, 4
(LL4 5
)LL5 6
==LL7 9
CategoryLL: B
.LLB C
MovieLLC H
.LLH I
ToStringLLI Q
(LLQ R
)LLR S
)LLS T
{MM 
TicketNN 
ticketNN %
=NN& '
newNN( +
TicketNN, 2
{OO 
IsAvailablePP '
=PP( )
truePP* .
,PP. /

ScreenplayQQ &
=QQ' (

screenplayQQ) 3
,QQ3 4
LocationRR $
=RR% &
	locationsRR' 0
[RR0 1
indexRR1 6
]RR6 7
,RR7 8
DateSS  
=SS! "
newSS# &
DateTimeSS' /
(SS/ 0
$numSS0 4
,SS4 5
$numSS6 7
,SS7 8
$numSS9 :
,SS: ;
$numSS< =
,SS= >
$numSS? @
,SS@ A
$numSSB C
)SSC D
}TT 
;TT 
contextUU 
.UU  
TicketsUU  '
.UU' (
AddUU( +
(UU+ ,
ticketUU, 2
)UU2 3
;UU3 4
}VV 
RatingYY 
ratingYY !
=YY" #
newYY$ '
RatingYY( .
{ZZ 
Rate[[ 
=[[ 
index[[ $
+[[% &
$num[[' (
,[[( )

Screenplay\\ "
=\\# $

screenplay\\% /
}]] 
;]] 
context^^ 
.^^ 
Ratings^^ #
.^^# $
Add^^$ '
(^^' (
rating^^( .
)^^. /
;^^/ 0
}__ 
}`` 
awaitaa 
contextaa 
.aa 
SaveChangesAsyncaa *
(aa* +
)aa+ ,
;aa, -
}bb 	
}cc 
}dd Í‡
îC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210921160506_Initial.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class 
Initial  
:! "
	Migration# ,
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
CreateTable

 (
(

( )
name 
: 
$str 
, 
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
	FirstName 
= 
table  %
.% &
Column& ,
<, -
string- 3
>3 4
(4 5
type5 9
:9 :
$str; J
,J K
nullableL T
:T U
trueV Z
)Z [
,[ \
LastName 
= 
table $
.$ %
Column% +
<+ ,
string, 2
>2 3
(3 4
type4 8
:8 9
$str: I
,I J
nullableK S
:S T
trueU Y
)Y Z
} 
, 
constraints 
: 
table "
=># %
{ 
table 
. 

PrimaryKey $
($ %
$str% 0
,0 1
x2 3
=>4 6
x7 8
.8 9
Id9 ;
); <
;< =
} 
) 
; 
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str #
,# $
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
. 

Annotation #
(# $
$str$ 8
,8 9
$str: @
)@ A
,A B
Name 
= 
table  
.  !
Column! '
<' (
string( .
>. /
(/ 0
type0 4
:4 5
$str6 E
,E F
	maxLengthG P
:P Q
$numR U
,U V
nullableW _
:_ `
truea e
)e f
,f g
NormalizedName "
=# $
table% *
.* +
Column+ 1
<1 2
string2 8
>8 9
(9 :
type: >
:> ?
$str@ O
,O P
	maxLengthQ Z
:Z [
$num\ _
,_ `
nullablea i
:i j
truek o
)o p
,p q
ConcurrencyStamp   $
=  % &
table  ' ,
.  , -
Column  - 3
<  3 4
string  4 :
>  : ;
(  ; <
type  < @
:  @ A
$str  B Q
,  Q R
nullable  S [
:  [ \
true  ] a
)  a b
}!! 
,!! 
constraints"" 
:"" 
table"" "
=>""# %
{## 
table$$ 
.$$ 

PrimaryKey$$ $
($$$ %
$str$$% 5
,$$5 6
x$$7 8
=>$$9 ;
x$$< =
.$$= >
Id$$> @
)$$@ A
;$$A B
}%% 
)%% 
;%% 
migrationBuilder'' 
.'' 
CreateTable'' (
(''( )
name(( 
:(( 
$str(( #
,((# $
columns)) 
:)) 
table)) 
=>)) !
new))" %
{** 
Id++ 
=++ 
table++ 
.++ 
Column++ %
<++% &
int++& )
>++) *
(++* +
type+++ /
:++/ 0
$str++1 6
,++6 7
nullable++8 @
:++@ A
false++B G
)++G H
.,, 

Annotation,, #
(,,# $
$str,,$ 8
,,,8 9
$str,,: @
),,@ A
,,,A B
	FirstName-- 
=-- 
table--  %
.--% &
Column--& ,
<--, -
string--- 3
>--3 4
(--4 5
type--5 9
:--9 :
$str--; J
,--J K
nullable--L T
:--T U
true--V Z
)--Z [
,--[ \
LastName.. 
=.. 
table.. $
...$ %
Column..% +
<..+ ,
string.., 2
>..2 3
(..3 4
type..4 8
:..8 9
$str..: I
,..I J
nullable..K S
:..S T
true..U Y
)..Y Z
,..Z [
UserName// 
=// 
table// $
.//$ %
Column//% +
<//+ ,
string//, 2
>//2 3
(//3 4
type//4 8
://8 9
$str//: I
,//I J
	maxLength//K T
://T U
$num//V Y
,//Y Z
nullable//[ c
://c d
true//e i
)//i j
,//j k
NormalizedUserName00 &
=00' (
table00) .
.00. /
Column00/ 5
<005 6
string006 <
>00< =
(00= >
type00> B
:00B C
$str00D S
,00S T
	maxLength00U ^
:00^ _
$num00` c
,00c d
nullable00e m
:00m n
true00o s
)00s t
,00t u
Email11 
=11 
table11 !
.11! "
Column11" (
<11( )
string11) /
>11/ 0
(110 1
type111 5
:115 6
$str117 F
,11F G
	maxLength11H Q
:11Q R
$num11S V
,11V W
nullable11X `
:11` a
true11b f
)11f g
,11g h
NormalizedEmail22 #
=22$ %
table22& +
.22+ ,
Column22, 2
<222 3
string223 9
>229 :
(22: ;
type22; ?
:22? @
$str22A P
,22P Q
	maxLength22R [
:22[ \
$num22] `
,22` a
nullable22b j
:22j k
true22l p
)22p q
,22q r
EmailConfirmed33 "
=33# $
table33% *
.33* +
Column33+ 1
<331 2
bool332 6
>336 7
(337 8
type338 <
:33< =
$str33> C
,33C D
nullable33E M
:33M N
false33O T
)33T U
,33U V
PasswordHash44  
=44! "
table44# (
.44( )
Column44) /
<44/ 0
string440 6
>446 7
(447 8
type448 <
:44< =
$str44> M
,44M N
nullable44O W
:44W X
true44Y ]
)44] ^
,44^ _
SecurityStamp55 !
=55" #
table55$ )
.55) *
Column55* 0
<550 1
string551 7
>557 8
(558 9
type559 =
:55= >
$str55? N
,55N O
nullable55P X
:55X Y
true55Z ^
)55^ _
,55_ `
ConcurrencyStamp66 $
=66% &
table66' ,
.66, -
Column66- 3
<663 4
string664 :
>66: ;
(66; <
type66< @
:66@ A
$str66B Q
,66Q R
nullable66S [
:66[ \
true66] a
)66a b
,66b c
PhoneNumber77 
=77  !
table77" '
.77' (
Column77( .
<77. /
string77/ 5
>775 6
(776 7
type777 ;
:77; <
$str77= L
,77L M
nullable77N V
:77V W
true77X \
)77\ ]
,77] ^ 
PhoneNumberConfirmed88 (
=88) *
table88+ 0
.880 1
Column881 7
<887 8
bool888 <
>88< =
(88= >
type88> B
:88B C
$str88D I
,88I J
nullable88K S
:88S T
false88U Z
)88Z [
,88[ \
TwoFactorEnabled99 $
=99% &
table99' ,
.99, -
Column99- 3
<993 4
bool994 8
>998 9
(999 :
type99: >
:99> ?
$str99@ E
,99E F
nullable99G O
:99O P
false99Q V
)99V W
,99W X

LockoutEnd:: 
=::  
table::! &
.::& '
Column::' -
<::- .
DateTimeOffset::. <
>::< =
(::= >
type::> B
:::B C
$str::D T
,::T U
nullable::V ^
:::^ _
true::` d
)::d e
,::e f
LockoutEnabled;; "
=;;# $
table;;% *
.;;* +
Column;;+ 1
<;;1 2
bool;;2 6
>;;6 7
(;;7 8
type;;8 <
:;;< =
$str;;> C
,;;C D
nullable;;E M
:;;M N
false;;O T
);;T U
,;;U V
AccessFailedCount<< %
=<<& '
table<<( -
.<<- .
Column<<. 4
<<<4 5
int<<5 8
><<8 9
(<<9 :
type<<: >
:<<> ?
$str<<@ E
,<<E F
nullable<<G O
:<<O P
false<<Q V
)<<V W
}== 
,== 
constraints>> 
:>> 
table>> "
=>>># %
{?? 
table@@ 
.@@ 

PrimaryKey@@ $
(@@$ %
$str@@% 5
,@@5 6
x@@7 8
=>@@9 ;
x@@< =
.@@= >
Id@@> @
)@@@ A
;@@A B
}AA 
)AA 
;AA 
migrationBuilderCC 
.CC 
CreateTableCC (
(CC( )
nameDD 
:DD 
$strDD #
,DD# $
columnsEE 
:EE 
tableEE 
=>EE !
newEE" %
{FF 
IdGG 
=GG 
tableGG 
.GG 
ColumnGG %
<GG% &
intGG& )
>GG) *
(GG* +
typeGG+ /
:GG/ 0
$strGG1 6
,GG6 7
nullableGG8 @
:GG@ A
falseGGB G
)GGG H
.HH 

AnnotationHH #
(HH# $
$strHH$ 8
,HH8 9
$strHH: @
)HH@ A
,HHA B
TitleII 
=II 
tableII !
.II! "
ColumnII" (
<II( )
stringII) /
>II/ 0
(II0 1
typeII1 5
:II5 6
$strII7 F
,IIF G
nullableIIH P
:IIP Q
falseIIR W
)IIW X
,IIX Y
DescriptionJJ 
=JJ  !
tableJJ" '
.JJ' (
ColumnJJ( .
<JJ. /
stringJJ/ 5
>JJ5 6
(JJ6 7
typeJJ7 ;
:JJ; <
$strJJ= L
,JJL M
nullableJJN V
:JJV W
falseJJX ]
)JJ] ^
,JJ^ _
ReleaseDateKK 
=KK  !
tableKK" '
.KK' (
ColumnKK( .
<KK. /
DateTimeKK/ 7
>KK7 8
(KK8 9
typeKK9 =
:KK= >
$strKK? J
,KKJ K
nullableKKL T
:KKT U
falseKKV [
)KK[ \
,KK\ ]
CategoryLL 
=LL 
tableLL $
.LL$ %
ColumnLL% +
<LL+ ,
stringLL, 2
>LL2 3
(LL3 4
typeLL4 8
:LL8 9
$strLL: I
,LLI J
nullableLLK S
:LLS T
trueLLU Y
)LLY Z
,LLZ [
PhotoUrlMM 
=MM 
tableMM $
.MM$ %
ColumnMM% +
<MM+ ,
stringMM, 2
>MM2 3
(MM3 4
typeMM4 8
:MM8 9
$strMM: I
,MMI J
nullableMMK S
:MMS T
trueMMU Y
)MMY Z
}NN 
,NN 
constraintsOO 
:OO 
tableOO "
=>OO# %
{PP 
tableQQ 
.QQ 

PrimaryKeyQQ $
(QQ$ %
$strQQ% 5
,QQ5 6
xQQ7 8
=>QQ9 ;
xQQ< =
.QQ= >
IdQQ> @
)QQ@ A
;QQA B
}RR 
)RR 
;RR 
migrationBuilderTT 
.TT 
CreateTableTT (
(TT( )
nameUU 
:UU 
$strUU (
,UU( )
columnsVV 
:VV 
tableVV 
=>VV !
newVV" %
{WW 
IdXX 
=XX 
tableXX 
.XX 
ColumnXX %
<XX% &
intXX& )
>XX) *
(XX* +
typeXX+ /
:XX/ 0
$strXX1 6
,XX6 7
nullableXX8 @
:XX@ A
falseXXB G
)XXG H
.YY 

AnnotationYY #
(YY# $
$strYY$ 8
,YY8 9
$strYY: @
)YY@ A
,YYA B
RoleIdZZ 
=ZZ 
tableZZ "
.ZZ" #
ColumnZZ# )
<ZZ) *
intZZ* -
>ZZ- .
(ZZ. /
typeZZ/ 3
:ZZ3 4
$strZZ5 :
,ZZ: ;
nullableZZ< D
:ZZD E
falseZZF K
)ZZK L
,ZZL M
	ClaimType[[ 
=[[ 
table[[  %
.[[% &
Column[[& ,
<[[, -
string[[- 3
>[[3 4
([[4 5
type[[5 9
:[[9 :
$str[[; J
,[[J K
nullable[[L T
:[[T U
true[[V Z
)[[Z [
,[[[ \

ClaimValue\\ 
=\\  
table\\! &
.\\& '
Column\\' -
<\\- .
string\\. 4
>\\4 5
(\\5 6
type\\6 :
:\\: ;
$str\\< K
,\\K L
nullable\\M U
:\\U V
true\\W [
)\\[ \
}]] 
,]] 
constraints^^ 
:^^ 
table^^ "
=>^^# %
{__ 
table`` 
.`` 

PrimaryKey`` $
(``$ %
$str``% :
,``: ;
x``< =
=>``> @
x``A B
.``B C
Id``C E
)``E F
;``F G
tableaa 
.aa 

ForeignKeyaa $
(aa$ %
namebb 
:bb 
$strbb F
,bbF G
columncc 
:cc 
xcc  !
=>cc" $
xcc% &
.cc& '
RoleIdcc' -
,cc- .
principalTabledd &
:dd& '
$strdd( 5
,dd5 6
principalColumnee '
:ee' (
$stree) -
,ee- .
onDeleteff  
:ff  !
ReferentialActionff" 3
.ff3 4
Cascadeff4 ;
)ff; <
;ff< =
}gg 
)gg 
;gg 
migrationBuilderii 
.ii 
CreateTableii (
(ii( )
namejj 
:jj 
$strjj (
,jj( )
columnskk 
:kk 
tablekk 
=>kk !
newkk" %
{ll 
Idmm 
=mm 
tablemm 
.mm 
Columnmm %
<mm% &
intmm& )
>mm) *
(mm* +
typemm+ /
:mm/ 0
$strmm1 6
,mm6 7
nullablemm8 @
:mm@ A
falsemmB G
)mmG H
.nn 

Annotationnn #
(nn# $
$strnn$ 8
,nn8 9
$strnn: @
)nn@ A
,nnA B
UserIdoo 
=oo 
tableoo "
.oo" #
Columnoo# )
<oo) *
intoo* -
>oo- .
(oo. /
typeoo/ 3
:oo3 4
$stroo5 :
,oo: ;
nullableoo< D
:ooD E
falseooF K
)ooK L
,ooL M
	ClaimTypepp 
=pp 
tablepp  %
.pp% &
Columnpp& ,
<pp, -
stringpp- 3
>pp3 4
(pp4 5
typepp5 9
:pp9 :
$strpp; J
,ppJ K
nullableppL T
:ppT U
trueppV Z
)ppZ [
,pp[ \

ClaimValueqq 
=qq  
tableqq! &
.qq& '
Columnqq' -
<qq- .
stringqq. 4
>qq4 5
(qq5 6
typeqq6 :
:qq: ;
$strqq< K
,qqK L
nullableqqM U
:qqU V
trueqqW [
)qq[ \
}rr 
,rr 
constraintsss 
:ss 
tabless "
=>ss# %
{tt 
tableuu 
.uu 

PrimaryKeyuu $
(uu$ %
$struu% :
,uu: ;
xuu< =
=>uu> @
xuuA B
.uuB C
IduuC E
)uuE F
;uuF G
tablevv 
.vv 

ForeignKeyvv $
(vv$ %
nameww 
:ww 
$strww F
,wwF G
columnxx 
:xx 
xxx  !
=>xx" $
xxx% &
.xx& '
UserIdxx' -
,xx- .
principalTableyy &
:yy& '
$stryy( 5
,yy5 6
principalColumnzz '
:zz' (
$strzz) -
,zz- .
onDelete{{  
:{{  !
ReferentialAction{{" 3
.{{3 4
Cascade{{4 ;
){{; <
;{{< =
}|| 
)|| 
;|| 
migrationBuilder~~ 
.~~ 
CreateTable~~ (
(~~( )
name 
: 
$str (
,( )
columns
ÄÄ 
:
ÄÄ 
table
ÄÄ 
=>
ÄÄ !
new
ÄÄ" %
{
ÅÅ 
LoginProvider
ÇÇ !
=
ÇÇ" #
table
ÇÇ$ )
.
ÇÇ) *
Column
ÇÇ* 0
<
ÇÇ0 1
string
ÇÇ1 7
>
ÇÇ7 8
(
ÇÇ8 9
type
ÇÇ9 =
:
ÇÇ= >
$str
ÇÇ? N
,
ÇÇN O
nullable
ÇÇP X
:
ÇÇX Y
false
ÇÇZ _
)
ÇÇ_ `
,
ÇÇ` a
ProviderKey
ÉÉ 
=
ÉÉ  !
table
ÉÉ" '
.
ÉÉ' (
Column
ÉÉ( .
<
ÉÉ. /
string
ÉÉ/ 5
>
ÉÉ5 6
(
ÉÉ6 7
type
ÉÉ7 ;
:
ÉÉ; <
$str
ÉÉ= L
,
ÉÉL M
nullable
ÉÉN V
:
ÉÉV W
false
ÉÉX ]
)
ÉÉ] ^
,
ÉÉ^ _!
ProviderDisplayName
ÑÑ '
=
ÑÑ( )
table
ÑÑ* /
.
ÑÑ/ 0
Column
ÑÑ0 6
<
ÑÑ6 7
string
ÑÑ7 =
>
ÑÑ= >
(
ÑÑ> ?
type
ÑÑ? C
:
ÑÑC D
$str
ÑÑE T
,
ÑÑT U
nullable
ÑÑV ^
:
ÑÑ^ _
true
ÑÑ` d
)
ÑÑd e
,
ÑÑe f
UserId
ÖÖ 
=
ÖÖ 
table
ÖÖ "
.
ÖÖ" #
Column
ÖÖ# )
<
ÖÖ) *
int
ÖÖ* -
>
ÖÖ- .
(
ÖÖ. /
type
ÖÖ/ 3
:
ÖÖ3 4
$str
ÖÖ5 :
,
ÖÖ: ;
nullable
ÖÖ< D
:
ÖÖD E
false
ÖÖF K
)
ÖÖK L
}
ÜÜ 
,
ÜÜ 
constraints
áá 
:
áá 
table
áá "
=>
áá# %
{
àà 
table
ââ 
.
ââ 

PrimaryKey
ââ $
(
ââ$ %
$str
ââ% :
,
ââ: ;
x
ââ< =
=>
ââ> @
new
ââA D
{
ââE F
x
ââG H
.
ââH I
LoginProvider
ââI V
,
ââV W
x
ââX Y
.
ââY Z
ProviderKey
ââZ e
}
ââf g
)
ââg h
;
ââh i
table
ää 
.
ää 

ForeignKey
ää $
(
ää$ %
name
ãã 
:
ãã 
$str
ãã F
,
ããF G
column
åå 
:
åå 
x
åå  !
=>
åå" $
x
åå% &
.
åå& '
UserId
åå' -
,
åå- .
principalTable
çç &
:
çç& '
$str
çç( 5
,
çç5 6
principalColumn
éé '
:
éé' (
$str
éé) -
,
éé- .
onDelete
èè  
:
èè  !
ReferentialAction
èè" 3
.
èè3 4
Cascade
èè4 ;
)
èè; <
;
èè< =
}
êê 
)
êê 
;
êê 
migrationBuilder
íí 
.
íí 
CreateTable
íí (
(
íí( )
name
ìì 
:
ìì 
$str
ìì '
,
ìì' (
columns
îî 
:
îî 
table
îî 
=>
îî !
new
îî" %
{
ïï 
UserId
ññ 
=
ññ 
table
ññ "
.
ññ" #
Column
ññ# )
<
ññ) *
int
ññ* -
>
ññ- .
(
ññ. /
type
ññ/ 3
:
ññ3 4
$str
ññ5 :
,
ññ: ;
nullable
ññ< D
:
ññD E
false
ññF K
)
ññK L
,
ññL M
RoleId
óó 
=
óó 
table
óó "
.
óó" #
Column
óó# )
<
óó) *
int
óó* -
>
óó- .
(
óó. /
type
óó/ 3
:
óó3 4
$str
óó5 :
,
óó: ;
nullable
óó< D
:
óóD E
false
óóF K
)
óóK L
}
òò 
,
òò 
constraints
ôô 
:
ôô 
table
ôô "
=>
ôô# %
{
öö 
table
õõ 
.
õõ 

PrimaryKey
õõ $
(
õõ$ %
$str
õõ% 9
,
õõ9 :
x
õõ; <
=>
õõ= ?
new
õõ@ C
{
õõD E
x
õõF G
.
õõG H
UserId
õõH N
,
õõN O
x
õõP Q
.
õõQ R
RoleId
õõR X
}
õõY Z
)
õõZ [
;
õõ[ \
table
úú 
.
úú 

ForeignKey
úú $
(
úú$ %
name
ùù 
:
ùù 
$str
ùù E
,
ùùE F
column
ûû 
:
ûû 
x
ûû  !
=>
ûû" $
x
ûû% &
.
ûû& '
RoleId
ûû' -
,
ûû- .
principalTable
üü &
:
üü& '
$str
üü( 5
,
üü5 6
principalColumn
†† '
:
††' (
$str
††) -
,
††- .
onDelete
°°  
:
°°  !
ReferentialAction
°°" 3
.
°°3 4
Cascade
°°4 ;
)
°°; <
;
°°< =
table
¢¢ 
.
¢¢ 

ForeignKey
¢¢ $
(
¢¢$ %
name
££ 
:
££ 
$str
££ E
,
££E F
column
§§ 
:
§§ 
x
§§  !
=>
§§" $
x
§§% &
.
§§& '
UserId
§§' -
,
§§- .
principalTable
•• &
:
••& '
$str
••( 5
,
••5 6
principalColumn
¶¶ '
:
¶¶' (
$str
¶¶) -
,
¶¶- .
onDelete
ßß  
:
ßß  !
ReferentialAction
ßß" 3
.
ßß3 4
Cascade
ßß4 ;
)
ßß; <
;
ßß< =
}
®® 
)
®® 
;
®® 
migrationBuilder
™™ 
.
™™ 
CreateTable
™™ (
(
™™( )
name
´´ 
:
´´ 
$str
´´ (
,
´´( )
columns
¨¨ 
:
¨¨ 
table
¨¨ 
=>
¨¨ !
new
¨¨" %
{
≠≠ 
UserId
ÆÆ 
=
ÆÆ 
table
ÆÆ "
.
ÆÆ" #
Column
ÆÆ# )
<
ÆÆ) *
int
ÆÆ* -
>
ÆÆ- .
(
ÆÆ. /
type
ÆÆ/ 3
:
ÆÆ3 4
$str
ÆÆ5 :
,
ÆÆ: ;
nullable
ÆÆ< D
:
ÆÆD E
false
ÆÆF K
)
ÆÆK L
,
ÆÆL M
LoginProvider
ØØ !
=
ØØ" #
table
ØØ$ )
.
ØØ) *
Column
ØØ* 0
<
ØØ0 1
string
ØØ1 7
>
ØØ7 8
(
ØØ8 9
type
ØØ9 =
:
ØØ= >
$str
ØØ? N
,
ØØN O
nullable
ØØP X
:
ØØX Y
false
ØØZ _
)
ØØ_ `
,
ØØ` a
Name
∞∞ 
=
∞∞ 
table
∞∞  
.
∞∞  !
Column
∞∞! '
<
∞∞' (
string
∞∞( .
>
∞∞. /
(
∞∞/ 0
type
∞∞0 4
:
∞∞4 5
$str
∞∞6 E
,
∞∞E F
nullable
∞∞G O
:
∞∞O P
false
∞∞Q V
)
∞∞V W
,
∞∞W X
Value
±± 
=
±± 
table
±± !
.
±±! "
Column
±±" (
<
±±( )
string
±±) /
>
±±/ 0
(
±±0 1
type
±±1 5
:
±±5 6
$str
±±7 F
,
±±F G
nullable
±±H P
:
±±P Q
true
±±R V
)
±±V W
}
≤≤ 
,
≤≤ 
constraints
≥≥ 
:
≥≥ 
table
≥≥ "
=>
≥≥# %
{
¥¥ 
table
µµ 
.
µµ 

PrimaryKey
µµ $
(
µµ$ %
$str
µµ% :
,
µµ: ;
x
µµ< =
=>
µµ> @
new
µµA D
{
µµE F
x
µµG H
.
µµH I
UserId
µµI O
,
µµO P
x
µµQ R
.
µµR S
LoginProvider
µµS `
,
µµ` a
x
µµb c
.
µµc d
Name
µµd h
}
µµi j
)
µµj k
;
µµk l
table
∂∂ 
.
∂∂ 

ForeignKey
∂∂ $
(
∂∂$ %
name
∑∑ 
:
∑∑ 
$str
∑∑ F
,
∑∑F G
column
∏∏ 
:
∏∏ 
x
∏∏  !
=>
∏∏" $
x
∏∏% &
.
∏∏& '
UserId
∏∏' -
,
∏∏- .
principalTable
ππ &
:
ππ& '
$str
ππ( 5
,
ππ5 6
principalColumn
∫∫ '
:
∫∫' (
$str
∫∫) -
,
∫∫- .
onDelete
ªª  
:
ªª  !
ReferentialAction
ªª" 3
.
ªª3 4
Cascade
ªª4 ;
)
ªª; <
;
ªª< =
}
ºº 
)
ºº 
;
ºº 
migrationBuilder
ææ 
.
ææ 
CreateTable
ææ (
(
ææ( )
name
øø 
:
øø 
$str
øø  
,
øø  !
columns
¿¿ 
:
¿¿ 
table
¿¿ 
=>
¿¿ !
new
¿¿" %
{
¡¡ 
Id
¬¬ 
=
¬¬ 
table
¬¬ 
.
¬¬ 
Column
¬¬ %
<
¬¬% &
int
¬¬& )
>
¬¬) *
(
¬¬* +
type
¬¬+ /
:
¬¬/ 0
$str
¬¬1 6
,
¬¬6 7
nullable
¬¬8 @
:
¬¬@ A
false
¬¬B G
)
¬¬G H
.
√√ 

Annotation
√√ #
(
√√# $
$str
√√$ 8
,
√√8 9
$str
√√: @
)
√√@ A
,
√√A B
	AppUserId
ƒƒ 
=
ƒƒ 
table
ƒƒ  %
.
ƒƒ% &
Column
ƒƒ& ,
<
ƒƒ, -
int
ƒƒ- 0
>
ƒƒ0 1
(
ƒƒ1 2
type
ƒƒ2 6
:
ƒƒ6 7
$str
ƒƒ8 =
,
ƒƒ= >
nullable
ƒƒ? G
:
ƒƒG H
true
ƒƒI M
)
ƒƒM N
}
≈≈ 
,
≈≈ 
constraints
∆∆ 
:
∆∆ 
table
∆∆ "
=>
∆∆# %
{
«« 
table
»» 
.
»» 

PrimaryKey
»» $
(
»»$ %
$str
»»% 2
,
»»2 3
x
»»4 5
=>
»»6 8
x
»»9 :
.
»»: ;
Id
»»; =
)
»»= >
;
»»> ?
table
…… 
.
…… 

ForeignKey
…… $
(
……$ %
name
   
:
   
$str
   A
,
  A B
column
ÀÀ 
:
ÀÀ 
x
ÀÀ  !
=>
ÀÀ" $
x
ÀÀ% &
.
ÀÀ& '
	AppUserId
ÀÀ' 0
,
ÀÀ0 1
principalTable
ÃÃ &
:
ÃÃ& '
$str
ÃÃ( 5
,
ÃÃ5 6
principalColumn
ÕÕ '
:
ÕÕ' (
$str
ÕÕ) -
,
ÕÕ- .
onDelete
ŒŒ  
:
ŒŒ  !
ReferentialAction
ŒŒ" 3
.
ŒŒ3 4
Restrict
ŒŒ4 <
)
ŒŒ< =
;
ŒŒ= >
}
œœ 
)
œœ 
;
œœ 
migrationBuilder
—— 
.
—— 
CreateTable
—— (
(
——( )
name
““ 
:
““ 
$str
““ '
,
““' (
columns
”” 
:
”” 
table
”” 
=>
”” !
new
””" %
{
‘‘ 
ActorsId
’’ 
=
’’ 
table
’’ $
.
’’$ %
Column
’’% +
<
’’+ ,
int
’’, /
>
’’/ 0
(
’’0 1
type
’’1 5
:
’’5 6
$str
’’7 <
,
’’< =
nullable
’’> F
:
’’F G
false
’’H M
)
’’M N
,
’’N O
ScreenplaysId
÷÷ !
=
÷÷" #
table
÷÷$ )
.
÷÷) *
Column
÷÷* 0
<
÷÷0 1
int
÷÷1 4
>
÷÷4 5
(
÷÷5 6
type
÷÷6 :
:
÷÷: ;
$str
÷÷< A
,
÷÷A B
nullable
÷÷C K
:
÷÷K L
false
÷÷M R
)
÷÷R S
}
◊◊ 
,
◊◊ 
constraints
ÿÿ 
:
ÿÿ 
table
ÿÿ "
=>
ÿÿ# %
{
ŸŸ 
table
⁄⁄ 
.
⁄⁄ 

PrimaryKey
⁄⁄ $
(
⁄⁄$ %
$str
⁄⁄% 9
,
⁄⁄9 :
x
⁄⁄; <
=>
⁄⁄= ?
new
⁄⁄@ C
{
⁄⁄D E
x
⁄⁄F G
.
⁄⁄G H
ActorsId
⁄⁄H P
,
⁄⁄P Q
x
⁄⁄R S
.
⁄⁄S T
ScreenplaysId
⁄⁄T a
}
⁄⁄b c
)
⁄⁄c d
;
⁄⁄d e
table
€€ 
.
€€ 

ForeignKey
€€ $
(
€€$ %
name
‹‹ 
:
‹‹ 
$str
‹‹ B
,
‹‹B C
column
›› 
:
›› 
x
››  !
=>
››" $
x
››% &
.
››& '
ActorsId
››' /
,
››/ 0
principalTable
ﬁﬁ &
:
ﬁﬁ& '
$str
ﬁﬁ( 0
,
ﬁﬁ0 1
principalColumn
ﬂﬂ '
:
ﬂﬂ' (
$str
ﬂﬂ) -
,
ﬂﬂ- .
onDelete
‡‡  
:
‡‡  !
ReferentialAction
‡‡" 3
.
‡‡3 4
Cascade
‡‡4 ;
)
‡‡; <
;
‡‡< =
table
·· 
.
·· 

ForeignKey
·· $
(
··$ %
name
‚‚ 
:
‚‚ 
$str
‚‚ L
,
‚‚L M
column
„„ 
:
„„ 
x
„„  !
=>
„„" $
x
„„% &
.
„„& '
ScreenplaysId
„„' 4
,
„„4 5
principalTable
‰‰ &
:
‰‰& '
$str
‰‰( 5
,
‰‰5 6
principalColumn
ÂÂ '
:
ÂÂ' (
$str
ÂÂ) -
,
ÂÂ- .
onDelete
ÊÊ  
:
ÊÊ  !
ReferentialAction
ÊÊ" 3
.
ÊÊ3 4
Cascade
ÊÊ4 ;
)
ÊÊ; <
;
ÊÊ< =
}
ÁÁ 
)
ÁÁ 
;
ÁÁ 
migrationBuilder
ÈÈ 
.
ÈÈ 
CreateTable
ÈÈ (
(
ÈÈ( )
name
ÍÍ 
:
ÍÍ 
$str
ÍÍ 
,
ÍÍ  
columns
ÎÎ 
:
ÎÎ 
table
ÎÎ 
=>
ÎÎ !
new
ÎÎ" %
{
ÏÏ 
Id
ÌÌ 
=
ÌÌ 
table
ÌÌ 
.
ÌÌ 
Column
ÌÌ %
<
ÌÌ% &
int
ÌÌ& )
>
ÌÌ) *
(
ÌÌ* +
type
ÌÌ+ /
:
ÌÌ/ 0
$str
ÌÌ1 6
,
ÌÌ6 7
nullable
ÌÌ8 @
:
ÌÌ@ A
false
ÌÌB G
)
ÌÌG H
.
ÓÓ 

Annotation
ÓÓ #
(
ÓÓ# $
$str
ÓÓ$ 8
,
ÓÓ8 9
$str
ÓÓ: @
)
ÓÓ@ A
,
ÓÓA B
Rate
ÔÔ 
=
ÔÔ 
table
ÔÔ  
.
ÔÔ  !
Column
ÔÔ! '
<
ÔÔ' (
int
ÔÔ( +
>
ÔÔ+ ,
(
ÔÔ, -
type
ÔÔ- 1
:
ÔÔ1 2
$str
ÔÔ3 8
,
ÔÔ8 9
nullable
ÔÔ: B
:
ÔÔB C
false
ÔÔD I
)
ÔÔI J
,
ÔÔJ K
ScreenplayId
  
=
! "
table
# (
.
( )
Column
) /
<
/ 0
int
0 3
>
3 4
(
4 5
type
5 9
:
9 :
$str
; @
,
@ A
nullable
B J
:
J K
false
L Q
)
Q R
}
ÒÒ 
,
ÒÒ 
constraints
ÚÚ 
:
ÚÚ 
table
ÚÚ "
=>
ÚÚ# %
{
ÛÛ 
table
ÙÙ 
.
ÙÙ 

PrimaryKey
ÙÙ $
(
ÙÙ$ %
$str
ÙÙ% 1
,
ÙÙ1 2
x
ÙÙ3 4
=>
ÙÙ5 7
x
ÙÙ8 9
.
ÙÙ9 :
Id
ÙÙ: <
)
ÙÙ< =
;
ÙÙ= >
table
ıı 
.
ıı 

ForeignKey
ıı $
(
ıı$ %
name
ˆˆ 
:
ˆˆ 
$str
ˆˆ C
,
ˆˆC D
column
˜˜ 
:
˜˜ 
x
˜˜  !
=>
˜˜" $
x
˜˜% &
.
˜˜& '
ScreenplayId
˜˜' 3
,
˜˜3 4
principalTable
¯¯ &
:
¯¯& '
$str
¯¯( 5
,
¯¯5 6
principalColumn
˘˘ '
:
˘˘' (
$str
˘˘) -
,
˘˘- .
onDelete
˙˙  
:
˙˙  !
ReferentialAction
˙˙" 3
.
˙˙3 4
Cascade
˙˙4 ;
)
˙˙; <
;
˙˙< =
}
˚˚ 
)
˚˚ 
;
˚˚ 
migrationBuilder
˝˝ 
.
˝˝ 
CreateTable
˝˝ (
(
˝˝( )
name
˛˛ 
:
˛˛ 
$str
˛˛ 
,
˛˛  
columns
ˇˇ 
:
ˇˇ 
table
ˇˇ 
=>
ˇˇ !
new
ˇˇ" %
{
ÄÄ 
Id
ÅÅ 
=
ÅÅ 
table
ÅÅ 
.
ÅÅ 
Column
ÅÅ %
<
ÅÅ% &
int
ÅÅ& )
>
ÅÅ) *
(
ÅÅ* +
type
ÅÅ+ /
:
ÅÅ/ 0
$str
ÅÅ1 6
,
ÅÅ6 7
nullable
ÅÅ8 @
:
ÅÅ@ A
false
ÅÅB G
)
ÅÅG H
.
ÇÇ 

Annotation
ÇÇ #
(
ÇÇ# $
$str
ÇÇ$ 8
,
ÇÇ8 9
$str
ÇÇ: @
)
ÇÇ@ A
,
ÇÇA B
ScreenplayId
ÉÉ  
=
ÉÉ! "
table
ÉÉ# (
.
ÉÉ( )
Column
ÉÉ) /
<
ÉÉ/ 0
int
ÉÉ0 3
>
ÉÉ3 4
(
ÉÉ4 5
type
ÉÉ5 9
:
ÉÉ9 :
$str
ÉÉ; @
,
ÉÉ@ A
nullable
ÉÉB J
:
ÉÉJ K
false
ÉÉL Q
)
ÉÉQ R
,
ÉÉR S
	BookingId
ÑÑ 
=
ÑÑ 
table
ÑÑ  %
.
ÑÑ% &
Column
ÑÑ& ,
<
ÑÑ, -
int
ÑÑ- 0
>
ÑÑ0 1
(
ÑÑ1 2
type
ÑÑ2 6
:
ÑÑ6 7
$str
ÑÑ8 =
,
ÑÑ= >
nullable
ÑÑ? G
:
ÑÑG H
true
ÑÑI M
)
ÑÑM N
,
ÑÑN O
Date
ÖÖ 
=
ÖÖ 
table
ÖÖ  
.
ÖÖ  !
Column
ÖÖ! '
<
ÖÖ' (
DateTime
ÖÖ( 0
>
ÖÖ0 1
(
ÖÖ1 2
type
ÖÖ2 6
:
ÖÖ6 7
$str
ÖÖ8 C
,
ÖÖC D
nullable
ÖÖE M
:
ÖÖM N
false
ÖÖO T
)
ÖÖT U
,
ÖÖU V
IsAvailable
ÜÜ 
=
ÜÜ  !
table
ÜÜ" '
.
ÜÜ' (
Column
ÜÜ( .
<
ÜÜ. /
bool
ÜÜ/ 3
>
ÜÜ3 4
(
ÜÜ4 5
type
ÜÜ5 9
:
ÜÜ9 :
$str
ÜÜ; @
,
ÜÜ@ A
nullable
ÜÜB J
:
ÜÜJ K
false
ÜÜL Q
)
ÜÜQ R
,
ÜÜR S
Location
áá 
=
áá 
table
áá $
.
áá$ %
Column
áá% +
<
áá+ ,
string
áá, 2
>
áá2 3
(
áá3 4
type
áá4 8
:
áá8 9
$str
áá: I
,
ááI J
nullable
ááK S
:
ááS T
true
ááU Y
)
ááY Z
}
àà 
,
àà 
constraints
ââ 
:
ââ 
table
ââ "
=>
ââ# %
{
ää 
table
ãã 
.
ãã 

PrimaryKey
ãã $
(
ãã$ %
$str
ãã% 1
,
ãã1 2
x
ãã3 4
=>
ãã5 7
x
ãã8 9
.
ãã9 :
Id
ãã: <
)
ãã< =
;
ãã= >
table
åå 
.
åå 

ForeignKey
åå $
(
åå$ %
name
çç 
:
çç 
$str
çç =
,
çç= >
column
éé 
:
éé 
x
éé  !
=>
éé" $
x
éé% &
.
éé& '
	BookingId
éé' 0
,
éé0 1
principalTable
èè &
:
èè& '
$str
èè( 2
,
èè2 3
principalColumn
êê '
:
êê' (
$str
êê) -
,
êê- .
onDelete
ëë  
:
ëë  !
ReferentialAction
ëë" 3
.
ëë3 4
Restrict
ëë4 <
)
ëë< =
;
ëë= >
table
íí 
.
íí 

ForeignKey
íí $
(
íí$ %
name
ìì 
:
ìì 
$str
ìì C
,
ììC D
column
îî 
:
îî 
x
îî  !
=>
îî" $
x
îî% &
.
îî& '
ScreenplayId
îî' 3
,
îî3 4
principalTable
ïï &
:
ïï& '
$str
ïï( 5
,
ïï5 6
principalColumn
ññ '
:
ññ' (
$str
ññ) -
,
ññ- .
onDelete
óó  
:
óó  !
ReferentialAction
óó" 3
.
óó3 4
Cascade
óó4 ;
)
óó; <
;
óó< =
}
òò 
)
òò 
;
òò 
migrationBuilder
öö 
.
öö 
CreateIndex
öö (
(
öö( )
name
õõ 
:
õõ 
$str
õõ 8
,
õõ8 9
table
úú 
:
úú 
$str
úú (
,
úú( )
column
ùù 
:
ùù 
$str
ùù '
)
ùù' (
;
ùù( )
migrationBuilder
üü 
.
üü 
CreateIndex
üü (
(
üü( )
name
†† 
:
†† 
$str
†† 2
,
††2 3
table
°° 
:
°° 
$str
°° )
,
°°) *
column
¢¢ 
:
¢¢ 
$str
¢¢  
)
¢¢  !
;
¢¢! "
migrationBuilder
§§ 
.
§§ 
CreateIndex
§§ (
(
§§( )
name
•• 
:
•• 
$str
•• %
,
••% &
table
¶¶ 
:
¶¶ 
$str
¶¶ $
,
¶¶$ %
column
ßß 
:
ßß 
$str
ßß (
,
ßß( )
unique
®® 
:
®® 
true
®® 
,
®® 
filter
©© 
:
©© 
$str
©© 6
)
©©6 7
;
©©7 8
migrationBuilder
´´ 
.
´´ 
CreateIndex
´´ (
(
´´( )
name
¨¨ 
:
¨¨ 
$str
¨¨ 2
,
¨¨2 3
table
≠≠ 
:
≠≠ 
$str
≠≠ )
,
≠≠) *
column
ÆÆ 
:
ÆÆ 
$str
ÆÆ  
)
ÆÆ  !
;
ÆÆ! "
migrationBuilder
∞∞ 
.
∞∞ 
CreateIndex
∞∞ (
(
∞∞( )
name
±± 
:
±± 
$str
±± 2
,
±±2 3
table
≤≤ 
:
≤≤ 
$str
≤≤ )
,
≤≤) *
column
≥≥ 
:
≥≥ 
$str
≥≥  
)
≥≥  !
;
≥≥! "
migrationBuilder
µµ 
.
µµ 
CreateIndex
µµ (
(
µµ( )
name
∂∂ 
:
∂∂ 
$str
∂∂ 1
,
∂∂1 2
table
∑∑ 
:
∑∑ 
$str
∑∑ (
,
∑∑( )
column
∏∏ 
:
∏∏ 
$str
∏∏  
)
∏∏  !
;
∏∏! "
migrationBuilder
∫∫ 
.
∫∫ 
CreateIndex
∫∫ (
(
∫∫( )
name
ªª 
:
ªª 
$str
ªª "
,
ªª" #
table
ºº 
:
ºº 
$str
ºº $
,
ºº$ %
column
ΩΩ 
:
ΩΩ 
$str
ΩΩ )
)
ΩΩ) *
;
ΩΩ* +
migrationBuilder
øø 
.
øø 
CreateIndex
øø (
(
øø( )
name
¿¿ 
:
¿¿ 
$str
¿¿ %
,
¿¿% &
table
¡¡ 
:
¡¡ 
$str
¡¡ $
,
¡¡$ %
column
¬¬ 
:
¬¬ 
$str
¬¬ ,
,
¬¬, -
unique
√√ 
:
√√ 
true
√√ 
,
√√ 
filter
ƒƒ 
:
ƒƒ 
$str
ƒƒ :
)
ƒƒ: ;
;
ƒƒ; <
migrationBuilder
∆∆ 
.
∆∆ 
CreateIndex
∆∆ (
(
∆∆( )
name
«« 
:
«« 
$str
«« -
,
««- .
table
»» 
:
»» 
$str
»» !
,
»»! "
column
…… 
:
…… 
$str
…… #
)
……# $
;
……$ %
migrationBuilder
ÀÀ 
.
ÀÀ 
CreateIndex
ÀÀ (
(
ÀÀ( )
name
ÃÃ 
:
ÃÃ 
$str
ÃÃ /
,
ÃÃ/ 0
table
ÕÕ 
:
ÕÕ 
$str
ÕÕ  
,
ÕÕ  !
column
ŒŒ 
:
ŒŒ 
$str
ŒŒ &
)
ŒŒ& '
;
ŒŒ' (
migrationBuilder
–– 
.
–– 
CreateIndex
–– (
(
––( )
name
—— 
:
—— 
$str
—— ,
,
——, -
table
““ 
:
““ 
$str
““  
,
““  !
column
”” 
:
”” 
$str
”” #
)
””# $
;
””$ %
migrationBuilder
’’ 
.
’’ 
CreateIndex
’’ (
(
’’( )
name
÷÷ 
:
÷÷ 
$str
÷÷ /
,
÷÷/ 0
table
◊◊ 
:
◊◊ 
$str
◊◊  
,
◊◊  !
column
ÿÿ 
:
ÿÿ 
$str
ÿÿ &
)
ÿÿ& '
;
ÿÿ' (
}
ŸŸ 	
	protected
€€ 
override
€€ 
void
€€ 
Down
€€  $
(
€€$ %
MigrationBuilder
€€% 5
migrationBuilder
€€6 F
)
€€F G
{
‹‹ 	
migrationBuilder
›› 
.
›› 
	DropTable
›› &
(
››& '
name
ﬁﬁ 
:
ﬁﬁ 
$str
ﬁﬁ '
)
ﬁﬁ' (
;
ﬁﬁ( )
migrationBuilder
‡‡ 
.
‡‡ 
	DropTable
‡‡ &
(
‡‡& '
name
·· 
:
·· 
$str
·· (
)
··( )
;
··) *
migrationBuilder
„„ 
.
„„ 
	DropTable
„„ &
(
„„& '
name
‰‰ 
:
‰‰ 
$str
‰‰ (
)
‰‰( )
;
‰‰) *
migrationBuilder
ÊÊ 
.
ÊÊ 
	DropTable
ÊÊ &
(
ÊÊ& '
name
ÁÁ 
:
ÁÁ 
$str
ÁÁ (
)
ÁÁ( )
;
ÁÁ) *
migrationBuilder
ÈÈ 
.
ÈÈ 
	DropTable
ÈÈ &
(
ÈÈ& '
name
ÍÍ 
:
ÍÍ 
$str
ÍÍ '
)
ÍÍ' (
;
ÍÍ( )
migrationBuilder
ÏÏ 
.
ÏÏ 
	DropTable
ÏÏ &
(
ÏÏ& '
name
ÌÌ 
:
ÌÌ 
$str
ÌÌ (
)
ÌÌ( )
;
ÌÌ) *
migrationBuilder
ÔÔ 
.
ÔÔ 
	DropTable
ÔÔ &
(
ÔÔ& '
name
 
:
 
$str
 
)
  
;
  !
migrationBuilder
ÚÚ 
.
ÚÚ 
	DropTable
ÚÚ &
(
ÚÚ& '
name
ÛÛ 
:
ÛÛ 
$str
ÛÛ 
)
ÛÛ  
;
ÛÛ  !
migrationBuilder
ıı 
.
ıı 
	DropTable
ıı &
(
ıı& '
name
ˆˆ 
:
ˆˆ 
$str
ˆˆ 
)
ˆˆ 
;
ˆˆ  
migrationBuilder
¯¯ 
.
¯¯ 
	DropTable
¯¯ &
(
¯¯& '
name
˘˘ 
:
˘˘ 
$str
˘˘ #
)
˘˘# $
;
˘˘$ %
migrationBuilder
˚˚ 
.
˚˚ 
	DropTable
˚˚ &
(
˚˚& '
name
¸¸ 
:
¸¸ 
$str
¸¸  
)
¸¸  !
;
¸¸! "
migrationBuilder
˛˛ 
.
˛˛ 
	DropTable
˛˛ &
(
˛˛& '
name
ˇˇ 
:
ˇˇ 
$str
ˇˇ #
)
ˇˇ# $
;
ˇˇ$ %
migrationBuilder
ÅÅ 
.
ÅÅ 
	DropTable
ÅÅ &
(
ÅÅ& '
name
ÇÇ 
:
ÇÇ 
$str
ÇÇ #
)
ÇÇ# $
;
ÇÇ$ %
}
ÉÉ 	
}
ÑÑ 
}ÖÖ à
ØC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210921163657_add-migation AddedStoredProcedures.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class ,
 addmigationAddedStoredProcedures 9
:: ;
	Migration< E
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
var		 !
spGetTop10RatedMovies		 %
=		& '
$str
 
; 
var *
spGetMostViewedMoviesForPeriod .
=/ 0
$str$ 
;$$ 
var&& ,
 spGetMostSoldMoviesWithoutRating&& 0
=&&1 2
$str'3 
;33 
migrationBuilder55 
.55 
Sql55  
(55  !!
spGetTop10RatedMovies55! 6
)556 7
;557 8
migrationBuilder66 
.66 
Sql66  
(66  !*
spGetMostViewedMoviesForPeriod66! ?
)66? @
;66@ A
migrationBuilder77 
.77 
Sql77  
(77  !,
 spGetMostSoldMoviesWithoutRating77! A
)77A B
;77B C
}88 	
	protected:: 
override:: 
void:: 
Down::  $
(::$ %
MigrationBuilder::% 5
migrationBuilder::6 F
)::F G
{;; 	
var<< !
spGetTop10RatedMovies<< %
=<<& '
$str<<( M
;<<M N
var== *
spGetMostViewedMoviesForPeriod== .
===/ 0
$str==1 _
;==_ `
var>> ,
 spGetMostSoldMoviesWithoutRating>> 0
=>>1 2
$str>>3 c
;>>c d
migrationBuilder@@ 
.@@ 
Sql@@  
(@@  !!
spGetTop10RatedMovies@@! 6
)@@6 7
;@@7 8
migrationBuilderAA 
.AA 
SqlAA  
(AA  !*
spGetMostViewedMoviesForPeriodAA! ?
)AA? @
;AA@ A
migrationBuilderBB 
.BB 
SqlBB  
(BB  !,
 spGetMostSoldMoviesWithoutRatingBB! A
)BBA B
;BBB C
}CC 	
}DD 
}EE ¯8
óC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210923125932_AddedEnums.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class 

AddedEnums #
:$ %
	Migration& /
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{		 	
migrationBuilder

 
.

 
AlterColumn

 (
<

( )
int

) ,
>

, -
(

- .
name 
: 
$str  
,  !
table 
: 
$str $
,$ %
type 
: 
$str 
, 
nullable 
: 
false 
,  
defaultValue 
: 
$num 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
,( )
oldNullable 
: 
true !
)! "
;" #
migrationBuilder 
. 
CreateTable (
(( )
name 
: 
$str .
,. /
columns 
: 
table 
=> !
new" %
{ 
Id 
= 
table 
. 
Column %
<% &
int& )
>) *
(* +
type+ /
:/ 0
$str1 6
,6 7
nullable8 @
:@ A
falseB G
)G H
,H I
Title 
= 
table !
.! "
Column" (
<( )
string) /
>/ 0
(0 1
type1 5
:5 6
$str7 F
,F G
nullableH P
:P Q
trueR V
)V W
,W X
number_of_ratings %
=& '
table( -
.- .
Column. 4
<4 5
int5 8
>8 9
(9 :
type: >
:> ?
$str@ E
,E F
nullableG O
:O P
falseQ V
)V W
} 
, 
constraints 
: 
table "
=># %
{ 
} 
) 
; 
migrationBuilder   
.   
CreateTable   (
(  ( )
name!! 
:!! 
$str!! 9
,!!9 :
columns"" 
:"" 
table"" 
=>"" !
new""" %
{## 
Id$$ 
=$$ 
table$$ 
.$$ 
Column$$ %
<$$% &
int$$& )
>$$) *
($$* +
type$$+ /
:$$/ 0
$str$$1 6
,$$6 7
nullable$$8 @
:$$@ A
false$$B G
)$$G H
,$$H I
Title%% 
=%% 
table%% !
.%%! "
Column%%" (
<%%( )
string%%) /
>%%/ 0
(%%0 1
type%%1 5
:%%5 6
$str%%7 F
,%%F G
nullable%%H P
:%%P Q
true%%R V
)%%V W
,%%W X
Location&& 
=&& 
table&& $
.&&$ %
Column&&% +
<&&+ ,
string&&, 2
>&&2 3
(&&3 4
type&&4 8
:&&8 9
$str&&: I
,&&I J
nullable&&K S
:&&S T
true&&U Y
)&&Y Z
,&&Z [
Date'' 
='' 
table''  
.''  !
Column''! '
<''' (
DateTime''( 0
>''0 1
(''1 2
type''2 6
:''6 7
$str''8 C
,''C D
nullable''E M
:''M N
false''O T
)''T U
,''U V
tickets_sold((  
=((! "
table((# (
.((( )
Column(() /
<((/ 0
int((0 3
>((3 4
(((4 5
type((5 9
:((9 :
$str((; @
,((@ A
nullable((B J
:((J K
false((L Q
)((Q R
})) 
,)) 
constraints** 
:** 
table** "
=>**# %
{++ 
},, 
),, 
;,, 
migrationBuilder.. 
... 
CreateTable.. (
(..( )
name// 
:// 
$str// 8
,//8 9
columns00 
:00 
table00 
=>00 !
new00" %
{11 
Id22 
=22 
table22 
.22 
Column22 %
<22% &
int22& )
>22) *
(22* +
type22+ /
:22/ 0
$str221 6
,226 7
nullable228 @
:22@ A
false22B G
)22G H
,22H I
Title33 
=33 
table33 !
.33! "
Column33" (
<33( )
int33) ,
>33, -
(33- .
type33. 2
:332 3
$str334 9
,339 :
nullable33; C
:33C D
false33E J
)33J K
,33K L
screening_number44 $
=44% &
table44' ,
.44, -
Column44- 3
<443 4
int444 7
>447 8
(448 9
type449 =
:44= >
$str44? D
,44D E
nullable44F N
:44N O
false44P U
)44U V
}55 
,55 
constraints66 
:66 
table66 "
=>66# %
{77 
}88 
)88 
;88 
}99 	
	protected;; 
override;; 
void;; 
Down;;  $
(;;$ %
MigrationBuilder;;% 5
migrationBuilder;;6 F
);;F G
{<< 	
migrationBuilder== 
.== 
	DropTable== &
(==& '
name>> 
:>> 
$str>> .
)>>. /
;>>/ 0
migrationBuilder@@ 
.@@ 
	DropTable@@ &
(@@& '
nameAA 
:AA 
$strAA 9
)AA9 :
;AA: ;
migrationBuilderCC 
.CC 
	DropTableCC &
(CC& '
nameDD 
:DD 
$strDD 8
)DD8 9
;DD9 :
migrationBuilderFF 
.FF 
AlterColumnFF (
<FF( )
stringFF) /
>FF/ 0
(FF0 1
nameGG 
:GG 
$strGG  
,GG  !
tableHH 
:HH 
$strHH $
,HH$ %
typeII 
:II 
$strII %
,II% &
nullableJJ 
:JJ 
trueJJ 
,JJ 

oldClrTypeKK 
:KK 
typeofKK "
(KK" #
intKK# &
)KK& '
,KK' (
oldTypeLL 
:LL 
$strLL 
)LL 
;LL  
}MM 	
}NN 
}OO ®
öC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210923133726_AddedEnumCast.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class 
AddedEnumCast &
:' (
	Migration) 2
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
AlterColumn		 (
<		( )
string		) /
>		/ 0
(		0 1
name

 
:

 
$str

  
,

  !
table 
: 
$str $
,$ %
type 
: 
$str %
,% &
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
int# &
)& '
,' (
oldType 
: 
$str 
) 
;  
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
int) ,
>, -
(- .
name 
: 
$str  
,  !
table 
: 
$str $
,$ %
type 
: 
$str 
, 
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
} 	
} 
} óÄ
†C:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210927073118_AddedDataAnnotation.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class 
AddedDataAnnotation ,
:- .
	Migration/ 8
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
DropForeignKey		 +
(		+ ,
name

 
:

 
$str

 9
,

9 :
table 
: 
$str !
)! "
;" #
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str  
,  !
table 
: 
$str  
,  !
type 
: 
$str %
,% &
	maxLength 
: 
$num 
, 
nullable 
: 
true 
, 

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
,( )
oldNullable 
: 
true !
)! "
;" #
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str 
, 
table 
: 
$str $
,$ %
type 
: 
$str %
,% &
	maxLength 
: 
$num 
, 
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
)( )
;) *
migrationBuilder   
.   
AlterColumn   (
<  ( )
string  ) /
>  / 0
(  0 1
name!! 
:!! 
$str!!  
,!!  !
table"" 
:"" 
$str"" $
,""$ %
type## 
:## 
$str## %
,##% &
	maxLength$$ 
:$$ 
$num$$ 
,$$ 
nullable%% 
:%% 
true%% 
,%% 

oldClrType&& 
:&& 
typeof&& "
(&&" #
string&&# )
)&&) *
,&&* +
oldType'' 
:'' 
$str'' (
,''( )
oldNullable(( 
:(( 
true(( !
)((! "
;((" #
migrationBuilder** 
.** 
AlterColumn** (
<**( )
string**) /
>**/ 0
(**0 1
name++ 
:++ 
$str++ #
,++# $
table,, 
:,, 
$str,, $
,,,$ %
type-- 
:-- 
$str-- %
,--% &
	maxLength.. 
:.. 
$num.. 
,.. 
nullable// 
:// 
false// 
,//  

oldClrType00 
:00 
typeof00 "
(00" #
string00# )
)00) *
,00* +
oldType11 
:11 
$str11 (
)11( )
;11) *
migrationBuilder33 
.33 
AlterColumn33 (
<33( )
int33) ,
>33, -
(33- .
name44 
:44 
$str44 !
,44! "
table55 
:55 
$str55 !
,55! "
type66 
:66 
$str66 
,66 
nullable77 
:77 
false77 
,77  
defaultValue88 
:88 
$num88 
,88  

oldClrType99 
:99 
typeof99 "
(99" #
int99# &
)99& '
,99' (
oldType:: 
::: 
$str:: 
,:: 
oldNullable;; 
:;; 
true;; !
);;! "
;;;" #
migrationBuilder== 
.== 
AlterColumn== (
<==( )
string==) /
>==/ 0
(==0 1
name>> 
:>> 
$str>>  
,>>  !
table?? 
:?? 
$str?? $
,??$ %
type@@ 
:@@ 
$str@@ %
,@@% &
	maxLengthAA 
:AA 
$numAA 
,AA 
nullableBB 
:BB 
trueBB 
,BB 

oldClrTypeCC 
:CC 
typeofCC "
(CC" #
stringCC# )
)CC) *
,CC* +
oldTypeDD 
:DD 
$strDD (
,DD( )
oldNullableEE 
:EE 
trueEE !
)EE! "
;EE" #
migrationBuilderGG 
.GG 
AlterColumnGG (
<GG( )
stringGG) /
>GG/ 0
(GG0 1
nameHH 
:HH 
$strHH !
,HH! "
tableII 
:II 
$strII $
,II$ %
typeJJ 
:JJ 
$strJJ %
,JJ% &
	maxLengthKK 
:KK 
$numKK 
,KK 
nullableLL 
:LL 
trueLL 
,LL 

oldClrTypeMM 
:MM 
typeofMM "
(MM" #
stringMM# )
)MM) *
,MM* +
oldTypeNN 
:NN 
$strNN (
,NN( )
oldNullableOO 
:OO 
trueOO !
)OO! "
;OO" #
migrationBuilderQQ 
.QQ 
AlterColumnQQ (
<QQ( )
stringQQ) /
>QQ/ 0
(QQ0 1
nameRR 
:RR 
$strRR  
,RR  !
tableSS 
:SS 
$strSS 
,SS  
typeTT 
:TT 
$strTT %
,TT% &
	maxLengthUU 
:UU 
$numUU 
,UU 
nullableVV 
:VV 
falseVV 
,VV  
defaultValueWW 
:WW 
$strWW  
,WW  !

oldClrTypeXX 
:XX 
typeofXX "
(XX" #
stringXX# )
)XX) *
,XX* +
oldTypeYY 
:YY 
$strYY (
,YY( )
oldNullableZZ 
:ZZ 
trueZZ !
)ZZ! "
;ZZ" #
migrationBuilder\\ 
.\\ 
AlterColumn\\ (
<\\( )
string\\) /
>\\/ 0
(\\0 1
name]] 
:]] 
$str]] !
,]]! "
table^^ 
:^^ 
$str^^ 
,^^  
type__ 
:__ 
$str__ %
,__% &
	maxLength`` 
:`` 
$num`` 
,`` 
nullableaa 
:aa 
falseaa 
,aa  
defaultValuebb 
:bb 
$strbb  
,bb  !

oldClrTypecc 
:cc 
typeofcc "
(cc" #
stringcc# )
)cc) *
,cc* +
oldTypedd 
:dd 
$strdd (
,dd( )
oldNullableee 
:ee 
trueee !
)ee! "
;ee" #
migrationBuildergg 
.gg 
AddForeignKeygg *
(gg* +
namehh 
:hh 
$strhh 9
,hh9 :
tableii 
:ii 
$strii !
,ii! "
columnjj 
:jj 
$strjj #
,jj# $
principalTablekk 
:kk 
$strkk  -
,kk- .
principalColumnll 
:ll  
$strll! %
,ll% &
onDeletemm 
:mm 
ReferentialActionmm +
.mm+ ,
Cascademm, 3
)mm3 4
;mm4 5
}nn 	
	protectedpp 
overridepp 
voidpp 
Downpp  $
(pp$ %
MigrationBuilderpp% 5
migrationBuilderpp6 F
)ppF G
{qq 	
migrationBuilderrr 
.rr 
DropForeignKeyrr +
(rr+ ,
namess 
:ss 
$strss 9
,ss9 :
tablett 
:tt 
$strtt !
)tt! "
;tt" #
migrationBuildervv 
.vv 
AlterColumnvv (
<vv( )
stringvv) /
>vv/ 0
(vv0 1
nameww 
:ww 
$strww  
,ww  !
tablexx 
:xx 
$strxx  
,xx  !
typeyy 
:yy 
$stryy %
,yy% &
nullablezz 
:zz 
truezz 
,zz 

oldClrType{{ 
:{{ 
typeof{{ "
({{" #
string{{# )
){{) *
,{{* +
oldType|| 
:|| 
$str|| (
,||( )
oldMaxLength}} 
:}} 
$num}} !
,}}! "
oldNullable~~ 
:~~ 
true~~ !
)~~! "
;~~" #
migrationBuilder
ÄÄ 
.
ÄÄ 
AlterColumn
ÄÄ (
<
ÄÄ( )
string
ÄÄ) /
>
ÄÄ/ 0
(
ÄÄ0 1
name
ÅÅ 
:
ÅÅ 
$str
ÅÅ 
,
ÅÅ 
table
ÇÇ 
:
ÇÇ 
$str
ÇÇ $
,
ÇÇ$ %
type
ÉÉ 
:
ÉÉ 
$str
ÉÉ %
,
ÉÉ% &
nullable
ÑÑ 
:
ÑÑ 
false
ÑÑ 
,
ÑÑ  

oldClrType
ÖÖ 
:
ÖÖ 
typeof
ÖÖ "
(
ÖÖ" #
string
ÖÖ# )
)
ÖÖ) *
,
ÖÖ* +
oldType
ÜÜ 
:
ÜÜ 
$str
ÜÜ (
,
ÜÜ( )
oldMaxLength
áá 
:
áá 
$num
áá !
)
áá! "
;
áá" #
migrationBuilder
ââ 
.
ââ 
AlterColumn
ââ (
<
ââ( )
string
ââ) /
>
ââ/ 0
(
ââ0 1
name
ää 
:
ää 
$str
ää  
,
ää  !
table
ãã 
:
ãã 
$str
ãã $
,
ãã$ %
type
åå 
:
åå 
$str
åå %
,
åå% &
nullable
çç 
:
çç 
true
çç 
,
çç 

oldClrType
éé 
:
éé 
typeof
éé "
(
éé" #
string
éé# )
)
éé) *
,
éé* +
oldType
èè 
:
èè 
$str
èè (
,
èè( )
oldMaxLength
êê 
:
êê 
$num
êê !
,
êê! "
oldNullable
ëë 
:
ëë 
true
ëë !
)
ëë! "
;
ëë" #
migrationBuilder
ìì 
.
ìì 
AlterColumn
ìì (
<
ìì( )
string
ìì) /
>
ìì/ 0
(
ìì0 1
name
îî 
:
îî 
$str
îî #
,
îî# $
table
ïï 
:
ïï 
$str
ïï $
,
ïï$ %
type
ññ 
:
ññ 
$str
ññ %
,
ññ% &
nullable
óó 
:
óó 
false
óó 
,
óó  

oldClrType
òò 
:
òò 
typeof
òò "
(
òò" #
string
òò# )
)
òò) *
,
òò* +
oldType
ôô 
:
ôô 
$str
ôô (
,
ôô( )
oldMaxLength
öö 
:
öö 
$num
öö !
)
öö! "
;
öö" #
migrationBuilder
úú 
.
úú 
AlterColumn
úú (
<
úú( )
int
úú) ,
>
úú, -
(
úú- .
name
ùù 
:
ùù 
$str
ùù !
,
ùù! "
table
ûû 
:
ûû 
$str
ûû !
,
ûû! "
type
üü 
:
üü 
$str
üü 
,
üü 
nullable
†† 
:
†† 
true
†† 
,
†† 

oldClrType
°° 
:
°° 
typeof
°° "
(
°°" #
int
°°# &
)
°°& '
,
°°' (
oldType
¢¢ 
:
¢¢ 
$str
¢¢ 
)
¢¢ 
;
¢¢  
migrationBuilder
§§ 
.
§§ 
AlterColumn
§§ (
<
§§( )
string
§§) /
>
§§/ 0
(
§§0 1
name
•• 
:
•• 
$str
••  
,
••  !
table
¶¶ 
:
¶¶ 
$str
¶¶ $
,
¶¶$ %
type
ßß 
:
ßß 
$str
ßß %
,
ßß% &
nullable
®® 
:
®® 
true
®® 
,
®® 

oldClrType
©© 
:
©© 
typeof
©© "
(
©©" #
string
©©# )
)
©©) *
,
©©* +
oldType
™™ 
:
™™ 
$str
™™ (
,
™™( )
oldMaxLength
´´ 
:
´´ 
$num
´´ !
,
´´! "
oldNullable
¨¨ 
:
¨¨ 
true
¨¨ !
)
¨¨! "
;
¨¨" #
migrationBuilder
ÆÆ 
.
ÆÆ 
AlterColumn
ÆÆ (
<
ÆÆ( )
string
ÆÆ) /
>
ÆÆ/ 0
(
ÆÆ0 1
name
ØØ 
:
ØØ 
$str
ØØ !
,
ØØ! "
table
∞∞ 
:
∞∞ 
$str
∞∞ $
,
∞∞$ %
type
±± 
:
±± 
$str
±± %
,
±±% &
nullable
≤≤ 
:
≤≤ 
true
≤≤ 
,
≤≤ 

oldClrType
≥≥ 
:
≥≥ 
typeof
≥≥ "
(
≥≥" #
string
≥≥# )
)
≥≥) *
,
≥≥* +
oldType
¥¥ 
:
¥¥ 
$str
¥¥ (
,
¥¥( )
oldMaxLength
µµ 
:
µµ 
$num
µµ !
,
µµ! "
oldNullable
∂∂ 
:
∂∂ 
true
∂∂ !
)
∂∂! "
;
∂∂" #
migrationBuilder
∏∏ 
.
∏∏ 
AlterColumn
∏∏ (
<
∏∏( )
string
∏∏) /
>
∏∏/ 0
(
∏∏0 1
name
ππ 
:
ππ 
$str
ππ  
,
ππ  !
table
∫∫ 
:
∫∫ 
$str
∫∫ 
,
∫∫  
type
ªª 
:
ªª 
$str
ªª %
,
ªª% &
nullable
ºº 
:
ºº 
true
ºº 
,
ºº 

oldClrType
ΩΩ 
:
ΩΩ 
typeof
ΩΩ "
(
ΩΩ" #
string
ΩΩ# )
)
ΩΩ) *
,
ΩΩ* +
oldType
ææ 
:
ææ 
$str
ææ (
,
ææ( )
oldMaxLength
øø 
:
øø 
$num
øø !
)
øø! "
;
øø" #
migrationBuilder
¡¡ 
.
¡¡ 
AlterColumn
¡¡ (
<
¡¡( )
string
¡¡) /
>
¡¡/ 0
(
¡¡0 1
name
¬¬ 
:
¬¬ 
$str
¬¬ !
,
¬¬! "
table
√√ 
:
√√ 
$str
√√ 
,
√√  
type
ƒƒ 
:
ƒƒ 
$str
ƒƒ %
,
ƒƒ% &
nullable
≈≈ 
:
≈≈ 
true
≈≈ 
,
≈≈ 

oldClrType
∆∆ 
:
∆∆ 
typeof
∆∆ "
(
∆∆" #
string
∆∆# )
)
∆∆) *
,
∆∆* +
oldType
«« 
:
«« 
$str
«« (
,
««( )
oldMaxLength
»» 
:
»» 
$num
»» !
)
»»! "
;
»»" #
migrationBuilder
   
.
   
AddForeignKey
   *
(
  * +
name
ÀÀ 
:
ÀÀ 
$str
ÀÀ 9
,
ÀÀ9 :
table
ÃÃ 
:
ÃÃ 
$str
ÃÃ !
,
ÃÃ! "
column
ÕÕ 
:
ÕÕ 
$str
ÕÕ #
,
ÕÕ# $
principalTable
ŒŒ 
:
ŒŒ 
$str
ŒŒ  -
,
ŒŒ- .
principalColumn
œœ 
:
œœ  
$str
œœ! %
,
œœ% &
onDelete
–– 
:
–– 
ReferentialAction
–– +
.
––+ ,
Restrict
––, 4
)
––4 5
;
––5 6
}
—— 	
}
““ 
}”” ‰
§C:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210927073854_UpdatedScreenplayEntity.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class #
UpdatedScreenplayEntity 0
:1 2
	Migration3 <
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
AlterColumn		 (
<		( )
string		) /
>		/ 0
(		0 1
name

 
:

 
$str

 #
,

# $
table 
: 
$str $
,$ %
type 
: 
$str &
,& '
	maxLength 
: 
$num 
,  
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str (
,( )
oldMaxLength 
: 
$num !
)! "
;" #
} 	
	protected 
override 
void 
Down  $
($ %
MigrationBuilder% 5
migrationBuilder6 F
)F G
{ 	
migrationBuilder 
. 
AlterColumn (
<( )
string) /
>/ 0
(0 1
name 
: 
$str #
,# $
table 
: 
$str $
,$ %
type 
: 
$str %
,% &
	maxLength 
: 
$num 
, 
nullable 
: 
false 
,  

oldClrType 
: 
typeof "
(" #
string# )
)) *
,* +
oldType 
: 
$str )
,) *
oldMaxLength 
: 
$num "
)" #
;# $
} 	
}   
}!! «+
ùC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210927095015_FluentAPIExample.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class 
FluentAPIExample )
:* +
	Migration, 5
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
	AddColumn		 &
<		& '
int		' *
>		* +
(		+ ,
name

 
:

 
$str

 "
,

" #
table 
: 
$str  
,  !
type 
: 
$str 
, 
nullable 
: 
true 
) 
;  
migrationBuilder 
. 
	AddColumn &
<& '
int' *
>* +
(+ ,
name 
: 
$str %
,% &
table 
: 
$str  
,  !
type 
: 
$str 
, 
nullable 
: 
true 
) 
;  
migrationBuilder 
. 
	AddColumn &
<& '
int' *
>* +
(+ ,
name 
: 
$str %
,% &
table 
: 
$str  
,  !
type 
: 
$str 
, 
nullable 
: 
false 
,  
defaultValue 
: 
$num 
)  
;  !
migrationBuilder 
. 
CreateIndex (
(( )
name 
: 
$str -
,- .
table 
: 
$str  
,  !
column 
: 
$str $
)$ %
;% &
migrationBuilder!! 
.!! 
CreateIndex!! (
(!!( )
name"" 
:"" 
$str"" 0
,""0 1
table## 
:## 
$str##  
,##  !
column$$ 
:$$ 
$str$$ '
)$$' (
;$$( )
migrationBuilder&& 
.&& 
AddForeignKey&& *
(&&* +
name'' 
:'' 
$str'' 6
,''6 7
table(( 
:(( 
$str((  
,((  !
column)) 
:)) 
$str)) $
,))$ %
principalTable** 
:** 
$str**  *
,*** +
principalColumn++ 
:++  
$str++! %
,++% &
onDelete,, 
:,, 
ReferentialAction,, +
.,,+ ,
Restrict,,, 4
),,4 5
;,,5 6
migrationBuilder.. 
... 
AddForeignKey.. *
(..* +
name// 
:// 
$str// <
,//< =
table00 
:00 
$str00  
,00  !
column11 
:11 
$str11 '
,11' (
principalTable22 
:22 
$str22  -
,22- .
principalColumn33 
:33  
$str33! %
,33% &
onDelete44 
:44 
ReferentialAction44 +
.44+ ,
Restrict44, 4
)444 5
;445 6
}55 	
	protected77 
override77 
void77 
Down77  $
(77$ %
MigrationBuilder77% 5
migrationBuilder776 F
)77F G
{88 	
migrationBuilder99 
.99 
DropForeignKey99 +
(99+ ,
name:: 
::: 
$str:: 6
,::6 7
table;; 
:;; 
$str;;  
);;  !
;;;! "
migrationBuilder== 
.== 
DropForeignKey== +
(==+ ,
name>> 
:>> 
$str>> <
,>>< =
table?? 
:?? 
$str??  
)??  !
;??! "
migrationBuilderAA 
.AA 
	DropIndexAA &
(AA& '
nameBB 
:BB 
$strBB -
,BB- .
tableCC 
:CC 
$strCC  
)CC  !
;CC! "
migrationBuilderEE 
.EE 
	DropIndexEE &
(EE& '
nameFF 
:FF 
$strFF 0
,FF0 1
tableGG 
:GG 
$strGG  
)GG  !
;GG! "
migrationBuilderII 
.II 

DropColumnII '
(II' (
nameJJ 
:JJ 
$strJJ "
,JJ" #
tableKK 
:KK 
$strKK  
)KK  !
;KK! "
migrationBuilderMM 
.MM 

DropColumnMM '
(MM' (
nameNN 
:NN 
$strNN %
,NN% &
tableOO 
:OO 
$strOO  
)OO  !
;OO! "
migrationBuilderQQ 
.QQ 

DropColumnQQ '
(QQ' (
nameRR 
:RR 
$strRR %
,RR% &
tableSS 
:SS 
$strSS  
)SS  !
;SS! "
}TT 	
}UU 
}VV ’+
§C:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Migrations\20210927095401_RemovedFluenAPI4Tickets.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '

Migrations' 1
{ 
public 

partial 
class #
RemovedFluenAPI4Tickets 0
:1 2
	Migration3 <
{ 
	protected 
override 
void 
Up  "
(" #
MigrationBuilder# 3
migrationBuilder4 D
)D E
{ 	
migrationBuilder		 
.		 
DropForeignKey		 +
(		+ ,
name

 
:

 
$str

 6
,

6 7
table 
: 
$str  
)  !
;! "
migrationBuilder 
. 
DropForeignKey +
(+ ,
name 
: 
$str <
,< =
table 
: 
$str  
)  !
;! "
migrationBuilder 
. 
	DropIndex &
(& '
name 
: 
$str -
,- .
table 
: 
$str  
)  !
;! "
migrationBuilder 
. 
	DropIndex &
(& '
name 
: 
$str 0
,0 1
table 
: 
$str  
)  !
;! "
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str "
," #
table 
: 
$str  
)  !
;! "
migrationBuilder 
. 

DropColumn '
(' (
name 
: 
$str %
,% &
table 
: 
$str  
)  !
;! "
migrationBuilder!! 
.!! 

DropColumn!! '
(!!' (
name"" 
:"" 
$str"" %
,""% &
table## 
:## 
$str##  
)##  !
;##! "
}$$ 	
	protected&& 
override&& 
void&& 
Down&&  $
(&&$ %
MigrationBuilder&&% 5
migrationBuilder&&6 F
)&&F G
{'' 	
migrationBuilder(( 
.(( 
	AddColumn(( &
<((& '
int((' *
>((* +
(((+ ,
name)) 
:)) 
$str)) "
,))" #
table** 
:** 
$str**  
,**  !
type++ 
:++ 
$str++ 
,++ 
nullable,, 
:,, 
true,, 
),, 
;,,  
migrationBuilder.. 
... 
	AddColumn.. &
<..& '
int..' *
>..* +
(..+ ,
name// 
:// 
$str// %
,//% &
table00 
:00 
$str00  
,00  !
type11 
:11 
$str11 
,11 
nullable22 
:22 
true22 
)22 
;22  
migrationBuilder44 
.44 
	AddColumn44 &
<44& '
int44' *
>44* +
(44+ ,
name55 
:55 
$str55 %
,55% &
table66 
:66 
$str66  
,66  !
type77 
:77 
$str77 
,77 
nullable88 
:88 
false88 
,88  
defaultValue99 
:99 
$num99 
)99  
;99  !
migrationBuilder;; 
.;; 
CreateIndex;; (
(;;( )
name<< 
:<< 
$str<< -
,<<- .
table== 
:== 
$str==  
,==  !
column>> 
:>> 
$str>> $
)>>$ %
;>>% &
migrationBuilder@@ 
.@@ 
CreateIndex@@ (
(@@( )
nameAA 
:AA 
$strAA 0
,AA0 1
tableBB 
:BB 
$strBB  
,BB  !
columnCC 
:CC 
$strCC '
)CC' (
;CC( )
migrationBuilderEE 
.EE 
AddForeignKeyEE *
(EE* +
nameFF 
:FF 
$strFF 6
,FF6 7
tableGG 
:GG 
$strGG  
,GG  !
columnHH 
:HH 
$strHH $
,HH$ %
principalTableII 
:II 
$strII  *
,II* +
principalColumnJJ 
:JJ  
$strJJ! %
,JJ% &
onDeleteKK 
:KK 
ReferentialActionKK +
.KK+ ,
RestrictKK, 4
)KK4 5
;KK5 6
migrationBuilderMM 
.MM 
AddForeignKeyMM *
(MM* +
nameNN 
:NN 
$strNN <
,NN< =
tableOO 
:OO 
$strOO  
,OO  !
columnPP 
:PP 
$strPP '
,PP' (
principalTableQQ 
:QQ 
$strQQ  -
,QQ- .
principalColumnRR 
:RR  
$strRR! %
,RR% &
onDeleteSS 
:SS 
ReferentialActionSS +
.SS+ ,
RestrictSS, 4
)SS4 5
;SS5 6
}TT 	
}UU 
}VV “
ëC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Repositories\BookingRepository.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Repositories' 3
{ 
public 

class 
BookingRepository "
:# $
IBookingRepository% 7
{ 
private 
readonly 
DataContext $
_context% -
;- .
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
UserManager $
<$ %
AppUser% ,
>, -
_userManager. :
;: ;
public 
BookingRepository  
(  !
DataContext! ,
context- 4
,4 5
IMapper6 =
mapper> D
,D E
UserManagerF Q
<Q R
AppUserR Y
>Y Z
userManager[ f
)f g
{ 	
_context 
= 
context 
; 
_mapper 
= 
mapper 
; 
_userManager 
= 
userManager &
;& '
} 	
public 
async 
Task 
< 
BookingResponse )
>) *
CreateBookingAsync+ =
(= > 
BookingInsertRequest> R
requestS Z
)Z [
{ 	
var   
booking   
=   
new   
Booking   %
{!! 
AppUser"" 
="" 
await"" 
_userManager""  ,
."", -
Users""- 2
.##  
SingleOrDefaultAsync## %
(##% &
x##& '
=>##( *
x##+ ,
.##, -
Id##- /
==##0 2
request##3 :
.##: ;
	AppUserId##; D
)##D E
,##E F
}$$ 
;$$ 
await&& 
_context&& 
.&& 
Bookings&& #
.&&# $
AddAsync&&$ ,
(&&, -
booking&&- 4
)&&4 5
;&&5 6
await'' 
_context'' 
.'' 
SaveChangesAsync'' +
(''+ ,
)'', -
;''- .
return(( 
_mapper(( 
.(( 
Map(( 
<(( 
BookingResponse(( .
>((. /
(((/ 0
booking((0 7
)((7 8
;((8 9
})) 	
}** 
}++ ∫
êC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Repositories\RatingRepository.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Repositories' 3
{ 
public 

class 
RatingRepository !
:" #
IRatingRepository$ 5
{ 
private 
readonly 
DataContext $
_context% -
;- .
private 
readonly 
IMapper  
_mapper! (
;( )
public 
RatingRepository 
(  
DataContext  +
context, 3
,3 4
IMapper5 <
mapper= C
)C D
{ 	
_context 
= 
context 
; 
_mapper 
= 
mapper 
; 
} 	
public 
async 
Task 
<  
RatingInsertResponse .
>. /
RateScreenplayAsync0 C
(C D
RatingInsertRequestD W
requestX _
)_ `
{ 	
var 
rating 
= 
new 
Rating #
{ 
Rate 
= 
request 
. 
Rate #
,# $
ScreenplayId 
= 
request &
.& '
ScreenplayId' 3
} 
; 
_context   
.   
Ratings   
.   
Add    
(    !
rating  ! '
)  ' (
;  ( )
await!! 
_context!! 
.!! 
SaveChangesAsync!! +
(!!+ ,
)!!, -
;!!- .
return"" 
_mapper"" 
."" 
Map"" 
<""  
RatingInsertResponse"" 3
>""3 4
(""4 5
rating""5 ;
)""; <
;""< =
}## 	
}$$ 
}%% †
êC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Repositories\ReportRepository.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Repositories' 3
{ 
public 

class 
ReportRepository !
:" #
IReportRepository$ 5
{ 
private 
readonly 
DataContext $
_context% -
;- .
public 
ReportRepository 
(  
DataContext  +
context, 3
)3 4
{ 	
_context 
= 
context 
; 
} 	
public 
async 
Task 
< 
IReadOnlyList '
<' (!
MostRatedMoviesReport( =
>= >
>> ?#
GetMostRatedMoviesAsync@ W
(W X
)X Y
{ 	
return 
await 
_context !
.! ""
MostRatedMoviesReports" 8
.8 9

FromSqlRaw9 C
<C D!
MostRatedMoviesReportD Y
>Y Z
(Z [
$str[ x
)x y
.y z
ToListAsync	z Ö
(
Ö Ü
)
Ü á
;
á à
} 	
public 
async 
Task 
< 
IReadOnlyList '
<' (-
!MostSoldMoviesWithoutRatingReport( I
>I J
>J K/
#GetMostSoldMoviesWithoutRatingAsyncL o
(o p
)p q
{ 	
return 
await 
_context !
.! "-
!MostSoldMoviesWithoutRatingReport" C
.C D

FromSqlRawD N
<N O-
!MostSoldMoviesWithoutRatingReportO p
>p q
(q r
$str	r ö
)
ö õ
.
õ ú
ToListAsync
ú ß
(
ß ®
)
® ©
;
© ™
} 	
public   
async   
Task   
<   
IReadOnlyList   '
<  ' (,
 MostViewedMoviesForAPeriodReport  ( H
>  H I
>  I J.
"GetMostViewedMoviesForAPeriodAsync  K m
(  m n
DateTime  n v
	startDate	  w Ä
,
  Ä Å
DateTime
  Ç ä
endDate
  ã í
)
  í ì
{!! 	
return"" 
await"" 
_context"" !
.""! ",
 MostViewedMoviesForAPeriodReport""" B
.""B C

FromSqlRaw""C M
<""M N,
 MostViewedMoviesForAPeriodReport""N n
>""n o
(""o p
$str	""p ü
,
""ü †
	startDate
""° ™
,
""™ ´
endDate
""¨ ≥
)
""≥ ¥
.
""¥ µ
ToListAsync
""µ ¿
(
""¿ ¡
)
""¡ ¬
;
""¬ √
}## 	
}$$ 
}%% Ûw
îC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Repositories\ScreenplayRepository.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Repositories' 3
{ 
public 

class  
ScreenplayRepository %
:& '!
IScreenplayRepository( =
{ 
private 
readonly 
DataContext $
_context% -
;- .
private 
readonly 
IMapper  
_mapper! (
;( )
public  
ScreenplayRepository #
(# $
DataContext$ /
context0 7
,7 8
IMapper9 @
mapperA G
)G H
{ 	
_context 
= 
context 
; 
_mapper 
= 
mapper 
; 
} 	
public 
async 
Task 
< 
ScreenplayResponse ,
>, -
GetScreenplayAsync. @
(@ A
intA D
idE G
)G H
{ 	
return   
_mapper   
.   
Map   
<   
ScreenplayResponse   1
>  1 2
(  2 3
await  3 8
_context  9 A
.  A B
Screenplays  B M
.  M N
Include  N U
(  U V
s  V W
=>  X Z
s  [ \
.  \ ]
Ratings  ] d
)  d e
.!!  
SingleOrDefaultAsync!! %
(!!% &
x!!& '
=>!!( *
x!!+ ,
.!!, -
Id!!- /
==!!0 2
id!!3 5
)!!5 6
)!!6 7
;!!7 8
}"" 	
public$$ 
async$$ 
Task$$ 
<$$ 
	PagedList$$ #
<$$# $
ScreenplayResponse$$$ 6
>$$6 7
>$$7 8
GetScreenplaysAsync$$9 L
($$L M!
ScreenplaysGetRequest$$M b
request$$c j
)$$j k
{%% 	
var&& 
query&& 
=&& 
_context&&  
.&&  !
Screenplays&&! ,
.'' 
Include'' 
('' 
s'' 
=>'' 
s'' 
.''  
Ratings''  '
)''' (
.(( 
Include(( 
((( 
s(( 
=>(( 
s(( 
.((  
Actors((  &
)((& '
.)) 
AsQueryable)) 
()) 
))) 
;)) 
query++ 
=++ 
query++ 
.++ 
Where++ 
(++  
x++  !
=>++" $
x++% &
.++& '
Category++' /
==++0 2
request++3 :
.++: ;
Category++; C
)++C D
.,, 
OrderByDescending,, "
(,," #
x,,# $
=>,,% '
x,,( )
.,,) *
Ratings,,* 1
.,,1 2
Average,,2 9
(,,9 :
a,,: ;
=>,,< >
a,,? @
.,,@ A
Rate,,A E
),,E F
),,F G
;,,G H 
GetFiltersFromSearch//  
(//  !
ref//! $
request//% ,
,//, -
ref//. 1
query//2 7
)//7 8
;//8 9
if11 
(11 
!11 
string11 
.11 
IsNullOrWhiteSpace11 *
(11* +
request11+ 2
.112 3
Search113 9
)119 :
)11: ;
{22 
query33 
=33 
query33 
.33 
Where33 #
(33# $
s33$ %
=>33& (
s33) *
.33* +
Description33+ 6
.336 7
Contains337 ?
(33? @
request33@ G
.33G H
Search33H N
)33N O
||33P R
s33S T
.33T U
Title33U Z
.33Z [
Contains33[ c
(33c d
request33d k
.33k l
Search33l r
)33r s
)33s t
;33t u
}44 
return66 
await66 
CreateAsync66 $
(66$ %
query77 
.77 
	ProjectTo77 
<77  
ScreenplayResponse77  2
>772 3
(773 4
_mapper774 ;
.77; <!
ConfigurationProvider77< Q
)77Q R
.77R S
AsNoTracking77S _
(77_ `
)77` a
,77a b
request88 
.88 

PageNumber88 "
,88" #
request88$ +
.88+ ,
PageSize88, 4
)884 5
;885 6
}99 	
public;; 
static;; 
async;; 
Task;;  
<;;  !
	PagedList;;! *
<;;* +
ScreenplayResponse;;+ =
>;;= >
>;;> ?
CreateAsync;;@ K
(;;K L

IQueryable;;L V
<;;V W
ScreenplayResponse;;W i
>;;i j
source;;k q
,;;q r
int;;s v

pageNumber	;;w Å
,
;;Å Ç
int
;;É Ü
pageSize
;;á è
)
;;è ê
{<< 	
var== 
count== 
=== 
await== 
source== $
.==$ %

CountAsync==% /
(==/ 0
)==0 1
;==1 2
var>> 
items>> 
=>> 
await>> 
source>> $
.>>$ %
Skip>>% )
(>>) *
(>>* +

pageNumber>>+ 5
->>6 7
$num>>8 9
)>>9 :
*>>; <
pageSize>>= E
)>>E F
.>>F G
Take>>G K
(>>K L
pageSize>>L T
)>>T U
.>>U V
ToListAsync>>V a
(>>a b
)>>b c
;>>c d
return@@ 
new@@ 
	PagedList@@  
<@@  !
ScreenplayResponse@@! 3
>@@3 4
(@@4 5
items@@5 :
,@@: ;
count@@< A
,@@A B

pageNumber@@C M
,@@M N
pageSize@@O W
)@@W X
;@@X Y
}AA 	
privateCC 
voidCC  
GetFiltersFromSearchCC )
(CC) *
refCC* -!
ScreenplaysGetRequestCC. C
requestCCD K
,CCK L
refCCM P

IQueryableCCQ [
<CC[ \

ScreenplayCC\ f
>CCf g
queryCCh m
)CCm n
{DD 	
boolEE  
stringEndsWithPhraseEE %
(EE% &
stringEE& ,
sEE- .
,EE. /
stringEE0 6
phraseEE7 =
)EE= >
=>EE? A
sFF 
.FF 
EndsWithFF 
(FF 
phraseFF !
+FF" #
$strFF$ '
,FF' (
StringComparisonFF) 9
.FF9 :$
CurrentCultureIgnoreCaseFF: R
)FFR S
||FFT V
sGG 
.GG 
EndsWithGG 
(GG 
phraseGG !
,GG! "
StringComparisonGG# 3
.GG3 4$
CurrentCultureIgnoreCaseGG4 L
)GGL M
?GGN O
trueGGP T
:GGU V
falseGGW \
;GG\ ]
boolII !
stringStarsWithPhraseII &
(II& '
stringII' -
sII. /
,II/ 0
stringII1 7
phraseII8 >
)II> ?
=>II@ B
sJJ 
.JJ 

StartsWithJJ 
(JJ 
phraseJJ #
,JJ# $
StringComparisonJJ% 5
.JJ5 6$
CurrentCultureIgnoreCaseJJ6 N
)JJN O
;JJO P
ifMM 
(MM 
!MM 
stringMM 
.MM 
IsNullOrWhiteSpaceMM *
(MM* +
requestMM+ 2
.MM2 3
SearchMM3 9
)MM9 :
)MM: ;
{NN 
varOO 
searchWordsOO 
=OO  !
requestOO" )
.OO) *
SearchOO* 0
.OO0 1
SplitOO1 6
(OO6 7
$charOO7 :
)OO: ;
;OO; <
tryQQ 
{RR 
ifTT 
(TT 
searchWordsTT #
.TT# $
CountTT$ )
(TT) *
)TT* +
==TT, .
$numTT/ 0
&&TT1 3 
stringEndsWithPhraseTT4 H
(TTH I
requestTTI P
.TTP Q
SearchTTQ W
,TTW X
$strTTY _
)TT_ `
)TT` a
{UU 
ifVV 
(VV 
intVV 
.VV  
TryParseVV  (
(VV( )
searchWordsVV) 4
[VV4 5
$numVV5 6
]VV6 7
,VV7 8
outVV9 <
intVV= @
numberOfStarsVVA N
)VVN O
)VVO P
{WW 
requestXX #
.XX# $
SearchXX$ *
=XX+ ,
nullXX- 1
;XX1 2
requestYY #
.YY# $

ExactStarsYY$ .
=YY/ 0
numberOfStarsYY1 >
;YY> ?
if[[ 
([[  
numberOfStars[[  -
>[[. /
$num[[0 1
&&[[2 4
numberOfStars[[5 B
<=[[C E
$num[[F G
)[[G H
{\\ 
query]]  %
=]]& '
query]]( -
.]]- .
Where]]. 3
(]]3 4
x]]4 5
=>]]6 8
(]]9 :
int]]: =
)]]= >
x]]> ?
.]]? @
Ratings]]@ G
.]]G H
Average]]H O
(]]O P
r]]P Q
=>]]R T
r]]U V
.]]V W
Rate]]W [
)]][ \
==]]] _
numberOfStars]]` m
)]]m n
;]]n o
}^^ 
}__ 
}`` 
elsecc 
ifcc 
(cc 
searchWordscc (
.cc( )
Countcc) .
(cc. /
)cc/ 0
==cc1 3
$numcc4 5
&&cc6 8 
stringEndsWithPhrasecc9 M
(ccM N
requestccN U
.ccU V
SearchccV \
,cc\ ]
$strcc^ d
)ccd e
&&dd !
stringStarsWithPhrasedd 0
(dd0 1
requestdd1 8
.dd8 9
Searchdd9 ?
,dd? @
$strddA K
)ddK L
)ddL M
{ee 
ifff 
(ff 
intff 
.ff  
TryParseff  (
(ff( )
searchWordsff) 4
[ff4 5
$numff5 6
]ff6 7
,ff7 8
outff9 <
intff= @
atLeastStarsffA M
)ffM N
)ffN O
{gg 
requesthh #
.hh# $
Searchhh$ *
=hh+ ,
nullhh- 1
;hh1 2
requestii #
.ii# $
AtLeastStarsii$ 0
=ii1 2
atLeastStarsii3 ?
;ii? @
ifkk 
(kk  
requestkk  '
.kk' (
AtLeastStarskk( 4
>=kk5 7
$numkk8 9
&&kk: <
requestkk= D
.kkD E
AtLeastStarskkE Q
<=kkR T
$numkkU V
)kkV W
{ll 
querymm  %
=mm& '
querymm( -
.mm- .
Wheremm. 3
(mm3 4
xmm4 5
=>mm6 8
xmm9 :
.mm: ;
Ratingsmm; B
.mmB C
AveragemmC J
(mmJ K
rmmK L
=>mmM O
rmmP Q
.mmQ R
RatemmR V
)mmV W
>=mmX Z
atLeastStarsmm[ g
)mmg h
;mmh i
}nn 
}oo 
}pp 
elsess 
ifss 
(ss 
searchWordsss (
.ss( )
Countss) .
(ss. /
)ss/ 0
==ss1 3
$numss4 5
&&ss6 8!
stringStarsWithPhrasess9 N
(ssN O
requestssO V
.ssV W
SearchssW ]
,ss] ^
$strss_ f
)ssf g
)ssg h
{tt 
ifuu 
(uu 
intuu 
.uu  
TryParseuu  (
(uu( )
searchWordsuu) 4
[uu4 5
$numuu5 6
]uu6 7
,uu7 8
outuu9 <
intuu= @
yearuuA E
)uuE F
)uuF G
{vv 
requestww #
.ww# $
Searchww$ *
=ww+ ,
nullww- 1
;ww1 2
requestxx #
.xx# $
NewerThanYearxx$ 1
=xx2 3
yearxx4 8
;xx8 9
ifzz 
(zz  
requestzz  '
.zz' (
NewerThanYearzz( 5
>=zz6 8
$numzz9 :
&&zz; =
requestzz> E
.zzE F
NewerThanYearzzF S
<=zzT V
DateTimezzW _
.zz_ `
Todayzz` e
.zze f
Yearzzf j
)zzj k
{{{ 
query||  %
=||& '
query||( -
.||- .
Where||. 3
(||3 4
x||4 5
=>||6 8
x||9 :
.||: ;
ReleaseDate||; F
.||F G
Year||G K
>||L M
year||N R
)||R S
;||S T
}}} 
}~~ 
} 
else
ÇÇ 
if
ÇÇ 
(
ÇÇ 
searchWords
ÇÇ (
.
ÇÇ( )
Count
ÇÇ) .
(
ÇÇ. /
)
ÇÇ/ 0
==
ÇÇ1 3
$num
ÇÇ4 5
&&
ÇÇ6 8"
stringEndsWithPhrase
ÇÇ9 M
(
ÇÇM N
request
ÇÇN U
.
ÇÇU V
Search
ÇÇV \
,
ÇÇ\ ]
$str
ÇÇ^ d
)
ÇÇd e
&&
ÉÉ #
stringStarsWithPhrase
ÉÉ 0
(
ÉÉ0 1
request
ÉÉ1 8
.
ÉÉ8 9
Search
ÉÉ9 ?
,
ÉÉ? @
$str
ÉÉA M
)
ÉÉM N
)
ÉÉN O
{
ÑÑ 
if
ÖÖ 
(
ÖÖ 
int
ÖÖ 
.
ÖÖ  
TryParse
ÖÖ  (
(
ÖÖ( )
searchWords
ÖÖ) 4
[
ÖÖ4 5
$num
ÖÖ5 6
]
ÖÖ6 7
,
ÖÖ7 8
out
ÖÖ9 <
int
ÖÖ= @
olderThanYears
ÖÖA O
)
ÖÖO P
)
ÖÖP Q
{
ÜÜ 
request
áá #
.
áá# $
Search
áá$ *
=
áá+ ,
null
áá- 1
;
áá1 2
request
àà #
.
àà# $
OlderThanYears
àà$ 2
=
àà3 4
olderThanYears
àà5 C
;
ààC D
if
ää 
(
ää  
request
ää  '
.
ää' (
OlderThanYears
ää( 6
>=
ää7 9
$num
ää: ;
)
ää; <
{
ãã 
query
åå  %
=
åå& '
query
åå( -
.
åå- .
Where
åå. 3
(
åå3 4
x
åå4 5
=>
åå6 8
x
åå9 :
.
åå: ;
ReleaseDate
åå; F
.
ååF G
Year
ååG K
<=
ååL N
DateTime
ååO W
.
ååW X
Now
ååX [
.
åå[ \
AddYears
åå\ d
(
ååd e
olderThanYears
ååe s
*
ååt u
(
ååv w
-
ååw x
$num
ååx y
)
ååy z
)
ååz {
.
åå{ |
Yearåå| Ä
)ååÄ Å
;ååÅ Ç
}
çç 
}
éé 
}
èè 
}
êê 
catch
ëë 
(
ëë 
	Exception
ëë  
ex
ëë! #
)
ëë# $
{
íí 
throw
ìì 
new
ìì "
ApplicationException
ìì 2
(
ìì2 3
ex
ìì3 5
.
ìì5 6
Message
ìì6 =
)
ìì= >
;
ìì> ?
}
îî 
}
ïï 
}
ññ 	
}
óó 
}òò Ï"
êC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Repositories\TicketRepository.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Repositories' 3
{ 
public 

class 
TicketRepository !
:" #
ITicketRepository$ 5
{ 
private 
readonly 
DataContext $
_context% -
;- .
private 
readonly 
IMapper  
_mapper! (
;( )
public 
TicketRepository 
(  
DataContext  +
context, 3
,3 4
IMapper5 <
mapper= C
)C D
{ 	
_context 
= 
context 
; 
_mapper 
= 
mapper 
; 
} 	
public 
async 
Task 
< 
IEnumerable %
<% &
TicketResponse& 4
>4 5
>5 6
GetTicketsAsync7 F
(F G
TicketsGetRequestG X
requestY `
)` a
{ 	
var 
query 
= 
_context  
.  !
Tickets! (
.( )
Include) 0
(0 1
t1 2
=>3 5
t6 7
.7 8

Screenplay8 B
)B C
.C D
AsQueryableD O
(O P
)P Q
;Q R
query 
= 
query 
. 
Where 
(  
x  !
=>" $
x% &
.& '
Date' +
==, .
request/ 6
.6 7
Date7 ;
&& 
x 
. 
Date 
> 
DateTime #
.# $
Now$ '
&&( *
x+ ,
., -
Location- 5
==6 8
request9 @
.@ A
LocationA I
&&   
x   
.   
IsAvailable   
==    "
true  # '
&&  ( *
x  + ,
.  , -

Screenplay  - 7
.  7 8
Id  8 :
==  ; =
request  > E
.  E F
ScreenplayId  F R
)  R S
.  S T
Take  T X
(  X Y
request  Y `
.  ` a
NumberOfTickets  a p
)  p q
;  q r
return"" 
_mapper"" 
."" 
Map"" 
<"" 
IEnumerable"" *
<""* +
TicketResponse""+ 9
>""9 :
>"": ;
(""; <
await""< A
query""B G
.""G H
ToListAsync""H S
(""S T
)""T U
)""U V
;""V W
}## 	
public%% 
async%% 
Task%% 
<%% 
TicketResponse%% (
>%%( )
UpdateTicketsAsync%%* <
(%%< =
UpdateTicketRequest%%= P
request%%Q X
)%%X Y
{&& 	
var'' 
ticket'' 
='' 
await'' 
_context'' '
.''' (
Tickets''( /
.''/ 0 
SingleOrDefaultAsync''0 D
(''D E
x''E F
=>''G I
x''J K
.''K L
Id''L N
==''O Q
request''R Y
.''Y Z
Id''Z \
)''\ ]
;''] ^
ticket)) 
.)) 
IsAvailable)) 
=))  
request))! (
.))( )
IsAvailable))) 4
;))4 5
ticket** 
.** 
	BookingId** 
=** 
request** &
.**& '
	BookingId**' 0
;**0 1
_context,, 
.,, 
Entry,, 
(,, 
ticket,, !
),,! "
.,," #
State,,# (
=,,) *
EntityState,,+ 6
.,,6 7
Modified,,7 ?
;,,? @
await-- 
_context-- 
.-- 
SaveChangesAsync-- +
(--+ ,
)--, -
;--- .
return.. 
_mapper.. 
... 
Map.. 
<.. 
TicketResponse.. -
>..- .
(... /
ticket../ 5
)..5 6
;..6 7
}// 	
}00 
}11 é5
äC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Services\AccountService.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Services' /
{ 
public 

class 
AccountService 
:  !
IAccountService" 1
{ 
private 
readonly 
IMapper  
_mapper! (
;( )
private 
readonly 
ITokenService &
_tokenService' 4
;4 5
private 
readonly 
UserManager $
<$ %
AppUser% ,
>, -
_userManager. :
;: ;
private 
readonly 
SignInManager &
<& '
AppUser' .
>. /
_singInManager0 >
;> ?
public 
AccountService 
( 
UserManager )
<) *
AppUser* 1
>1 2
userManager3 >
,> ?
SignInManager@ M
<M N
AppUserN U
>U V
singInManagerW d
,d e
ITokenServicef s
tokenService	t Ä
,
Ä Å
IMapper
Ç â
mapper
ä ê
)
ê ë
{ 	
_userManager 
= 
userManager &
;& '
_singInManager 
= 
singInManager *
;* +
_tokenService 
= 
tokenService (
;( )
_mapper 
= 
mapper 
; 
} 	
public   
async   
Task   
<   
AccountResponse   )
>  ) *
Register  + 3
(  3 4"
RegisterAccountRequest  4 J
request  K R
)  R S
{!! 	
if"" 
("" 
await"" 

UserExists""  
(""  !
request""! (
.""( )
UserName"") 1
)""1 2
)""2 3
throw""4 9
new"": =
BadRequestException""> Q
(""Q R
$str""R _
)""_ `
;""` a
var$$ 
user$$ 
=$$ 
_mapper$$ 
.$$ 
Map$$ "
<$$" #
AppUser$$# *
>$$* +
($$+ ,
request$$, 3
)$$3 4
;$$4 5
if%% 
(%% 
user%% 
is%% 
null%% 
)%% 
throw%% #
new%%$ ' 
ApplicationException%%( <
(%%< =
$str%%= P
)%%P Q
;%%Q R
user'' 
.'' 
UserName'' 
='' 
request'' #
.''# $
UserName''$ ,
.'', -
ToLower''- 4
(''4 5
)''5 6
;''6 7
var)) 
result)) 
=)) 
await)) 
_userManager)) +
.))+ ,
CreateAsync)), 7
())7 8
user))8 <
,))< =
request))> E
.))E F
Password))F N
)))N O
;))O P
var** 

roleResult** 
=** 
await** "
_userManager**# /
.**/ 0
AddToRoleAsync**0 >
(**> ?
user**? C
,**C D
$str**E O
)**O P
;**P Q
return,, 
new,, 
AccountResponse,, &
{-- 
UserName.. 
=.. 
user.. 
...  
UserName..  (
,..( )
	FirstName// 
=// 
user//  
.//  !
	FirstName//! *
,//* +
LastName00 
=00 
user00 
.00  
LastName00  (
,00( )
Token11 
=11 
await11 
_tokenService11 +
.11+ ,
CreateToken11, 7
(117 8
user118 <
)11< =
}22 
;22 
}33 	
public55 
async55 
Task55 
<55 
AccountResponse55 )
>55) *
Login55+ 0
(550 1
LoginAccountRequest551 D
request55E L
)55L M
{66 	
var88 
user88 
=88 
await88 
_userManager88 )
.88) *
Users88* /
.99  
SingleOrDefaultAsync99 $
(99$ %
x99% &
=>99' )
x99* +
.99+ ,
UserName99, 4
==995 7
request998 ?
.99? @
UserName99@ H
.99H I
ToLower99I P
(99P Q
)99Q R
)99R S
;99S T
if;; 
(;; 
user;; 
is;; 
null;; 
);; 
throw;; #
new;;$ '
BadRequestException;;( ;
(;;; <
$str;;< N
);;N O
;;;O P
var== 
result== 
=== 
await== 
_singInManager== -
.==- .$
CheckPasswordSignInAsync==. F
(==F G
user==G K
,==K L
request==M T
.==T U
Password==U ]
,==] ^
false==_ d
)==d e
;==e f
if>> 
(>> 
!>> 
result>> 
.>> 
	Succeeded>> !
)>>! "
throw>># (
new>>) ,$
ForbiddenAccessException>>- E
(>>E F
$str>>F T
)>>T U
;>>U V
return@@ 
new@@ 
AccountResponse@@ &
{AA 
UserNameBB 
=BB 
userBB 
.BB  
UserNameBB  (
,BB( )
	FirstNameCC 
=CC 
userCC  
.CC  !
	FirstNameCC! *
,CC* +
LastNameDD 
=DD 
userDD 
.DD  
LastNameDD  (
,DD( )
TokenEE 
=EE 
awaitEE 
_tokenServiceEE +
.EE+ ,
CreateTokenEE, 7
(EE7 8
userEE8 <
)EE< =
}FF 
;FF 
}GG 	
privateII 
asyncII 
TaskII 
<II 
boolII 
>II  

UserExistsII! +
(II+ ,
stringII, 2
usernameII3 ;
)II; <
{JJ 	
returnKK 
awaitKK 
_userManagerKK %
.KK% &
UsersKK& +
.KK+ ,
AnyAsyncKK, 4
(KK4 5
xKK5 6
=>KK7 9
xKK: ;
.KK; <
UserNameKK< D
==KKE G
usernameKKH P
.KKP Q
ToLowerKKQ X
(KKX Y
)KKY Z
)KKZ [
;KK[ \
}LL 	
}MM 
}NN ‘
äC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Services\BookingService.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Services' /
{ 
public 

class 
BookingService 
:  !
IBookingService" 1
{ 
private 
readonly 
IBookingRepository +
_bookingRepository, >
;> ?
private 
readonly 
ITicketService '
_ticketService( 6
;6 7
private 
readonly 
UserManager $
<$ %
AppUser% ,
>, -
_userManager. :
;: ;
public 
BookingService 
( 
IBookingRepository 0
bookingRepository1 B
,B C
ITicketServiceD R
ticketServiceS `
,` a
UserManagerb m
<m n
AppUsern u
>u v
userManager	w Ç
)
Ç É
{ 	
_bookingRepository 
=  
bookingRepository! 2
;2 3
_ticketService 
= 
ticketService *
;* +
_userManager 
= 
userManager &
;& '
} 	
public 
async 
Task 
< 
BookingResponse )
>) *
CreateBookingAsync+ =
(= > 
BookingInsertRequest> R
requestS Z
)Z [
{ 	
var 
ticketParams 
= 
new "
TicketsGetRequest# 4
{ 
ScreenplayId   
=   
request   &
.  & '
ScreenplayId  ' 3
,  3 4
Date!! 
=!! 
request!! 
.!! 
Date!! #
,!!# $
Location"" 
="" 
request"" "
.""" #
Location""# +
,""+ ,
NumberOfTickets## 
=##  !
request##" )
.##) *
NumberOfTickets##* 9
}$$ 
;$$ 
var'' 
tickets'' 
='' 
await'' 
_ticketService''  .
.''. /
GetTicketsAsync''/ >
(''> ?
ticketParams''? K
)''K L
;''L M
var)) 
booking)) 
=)) 
await)) 
_bookingRepository))  2
.))2 3
CreateBookingAsync))3 E
())E F
request))F M
)))M N
;))N O
foreach,, 
(,, 
var,, 
ticket,, 
in,,  "
tickets,,# *
),,* +
{-- 
var.. 
updateTicketRequest.. '
=..( )
new..* -
UpdateTicketRequest... A
{// 
IsAvailable00 
=00  !
false00" '
,00' (
	BookingId11 
=11 
booking11  '
.11' (
Id11( *
,11* +
Id22 
=22 
ticket22 
.22  
Id22  "
}33 
;33 
await44 
_ticketService44 $
.44$ %
UpdateTicketsAsync44% 7
(447 8
updateTicketRequest448 K
)44K L
;44L M
}55 
return77 
booking77 
;77 
}99 	
}:: 
};; ä
âC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Services\RatingService.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Services' /
{ 
public 

class 
RatingService 
:  
IRatingService! /
{ 
private 
readonly 
IRatingRepository *
_ratingRepository+ <
;< =
private 
readonly !
IScreenplayRepository .!
_screenplayRepository/ D
;D E
public 
RatingService 
( 
IRatingRepository .
ratingRepository/ ?
,? @!
IScreenplayRepositoryA V 
screenplayRepositoryW k
)k l
{ 	
_ratingRepository 
= 
ratingRepository  0
;0 1!
_screenplayRepository !
=" # 
screenplayRepository$ 8
;8 9
} 	
public 
async 
Task 
<  
RatingInsertResponse .
>. /
RateScreenplay0 >
(> ?
RatingInsertRequest? R
requestS Z
)Z [
{ 	
if 
( 
request 
. 
Rate 
< 
$num  
||! #
request$ +
.+ ,
Rate, 0
>1 2
$num3 4
)4 5
throw6 ;
new< ?
BadRequestException@ S
(S T
$strT r
)r s
;s t
if 
( 
request 
. 
ScreenplayId $
<% &
$num' (
)( )
throw* /
new0 3
BadRequestException4 G
(G H
$strH ^
)^ _
;_ `
var 
response 
= 
await  
_ratingRepository! 2
.2 3
RateScreenplayAsync3 F
(F G
requestG N
)N O
;O P
if 
( 
response 
is 
null  
)  !
throw" '
new( +
NotFoundException, =
(= >
$str> U
)U V
;V W
var 

screenplay 
= 
await "!
_screenplayRepository# 8
.8 9
GetScreenplayAsync9 K
(K L
requestL S
.S T
ScreenplayIdT `
)` a
;a b
response   
.   
averageRate    
=  ! "

screenplay  # -
.  - .
AverageRate  . 9
;  9 :
return"" 
response"" 
;"" 
}## 	
}$$ 
}%% ÿ
âC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Services\ReportService.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Services' /
{ 
public 

class 
ReportService 
:  
IReportService! /
{ 
private 
readonly 
IReportRepository *
_reportRepository+ <
;< =
public 
ReportService 
( 
IReportRepository .
reportRepository/ ?
)? @
{ 	
_reportRepository 
= 
reportRepository  0
;0 1
} 	
public 
async 
Task 
< 
IReadOnlyList '
<' (!
MostRatedMoviesReport( =
>= >
>> ?#
GetMostRatedMoviesAsync@ W
(W X
)X Y
{ 	
var 
report 
= 
await 
_reportRepository 0
.0 1#
GetMostRatedMoviesAsync1 H
(H I
)I J
;J K
if 
( 
report 
is 
null 
) 
throw  %
new& )
NotFoundException* ;
(; <
$str< [
)[ \
;\ ]
return 
report 
; 
} 	
public 
async 
Task 
< 
IReadOnlyList '
<' (-
!MostSoldMoviesWithoutRatingReport( I
>I J
>J K/
#GetMostSoldMoviesWithoutRatingAsyncL o
(o p
)p q
{   	
var!! 
report!! 
=!! 
await!! 
_reportRepository!!  1
.!!1 2/
#GetMostSoldMoviesWithoutRatingAsync!!2 U
(!!U V
)!!V W
;!!W X
if"" 
("" 
report"" 
is"" 
null"" 
)"" 
throw""  %
new""& )
NotFoundException""* ;
(""; <
$str""< [
)""[ \
;""\ ]
return$$ 
report$$ 
;$$ 
}%% 	
public'' 
async'' 
Task'' 
<'' 
IReadOnlyList'' '
<''' (,
 MostViewedMoviesForAPeriodReport''( H
>''H I
>''I J.
"GetMostViewedMoviesForAPeriodAsync''K m
(''m n'
MostViewedMoviesGetRequest	''n à
request
''â ê
)
''ê ë
{(( 	
if)) 
()) 
request)) 
.)) 
	StartDate)) !
<))" #
request))$ +
.))+ ,
EndDate)), 3
)))3 4
throw))5 :
new)); >
BadRequestException))? R
())R S
$str	))S Ç
)
))Ç É
;
))É Ñ
var++ 
report++ 
=++ 
await++ 
_reportRepository++ 0
.++0 1.
"GetMostViewedMoviesForAPeriodAsync++1 S
(++S T
request++T [
.++[ \
	StartDate++\ e
,++e f
request++g n
.++n o
EndDate++o v
)++v w
;++w x
if,, 
(,, 
report,, 
is,, 
null,, 
),, 
throw,,  %
new,,& )
NotFoundException,,* ;
(,,; <
$str,,< [
),,[ \
;,,\ ]
return.. 
report.. 
;.. 
}// 	
}00 
}11 Ú
çC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Services\ScreenplayService.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Services' /
{ 
public 

class 
ScreenplayService "
:# $
IScreenplayService% 7
{ 
private 
readonly !
IScreenplayRepository .!
_screenplayRepository/ D
;D E
public 
ScreenplayService  
(  !!
IScreenplayRepository! 6 
screenplayRepository7 K
)K L
{ 	!
_screenplayRepository !
=" # 
screenplayRepository$ 8
;8 9
} 	
public 
async 
Task 
< 
	PagedList #
<# $
ScreenplayResponse$ 6
>6 7
>7 8
GetScreenplaysAsync9 L
(L M!
ScreenplaysGetRequestM b
requestc j
)j k
{ 	
var 
screenplays 
= 
await #!
_screenplayRepository$ 9
.9 :
GetScreenplaysAsync: M
(M N
requestN U
)U V
;V W
if 
( 
screenplays 
. 
Items !
.! "
Count" '
(' (
)( )
==* ,
$num- .
). /
throw0 5
new6 9
NotFoundException: K
(K L
$strL W
)W X
;X Y
return 
screenplays 
; 
} 	
public 
async 
Task 
< 
ScreenplayResponse ,
>, -
GetScreenplayAsync. @
(@ A
intA D
idE G
)G H
{   	
var!! 

screenplay!! 
=!! 
await!! "!
_screenplayRepository!!# 8
.!!8 9
GetScreenplayAsync!!9 K
(!!K L
id!!L N
)!!N O
;!!O P
if"" 
("" 

screenplay"" 
is"" 
null"" "
)""" #
throw""$ )
new""* -
NotFoundException"". ?
(""? @
$str""@ f
)""f g
;""g h
return$$ 

screenplay$$ 
;$$ 
}%% 	
}&& 
}'' î
âC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Services\TicketService.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Services' /
{ 
public 

class 
TicketService 
:  
ITicketService! /
{ 
private 
readonly 
ITicketRepository *
_ticketRepository+ <
;< =
public 
TicketService 
( 
ITicketRepository .
ticketRepository/ ?
)? @
{ 	
_ticketRepository 
= 
ticketRepository  0
;0 1
} 	
public 
async 
Task 
< 
IEnumerable %
<% &
TicketResponse& 4
>4 5
>5 6
GetTicketsAsync7 F
(F G
TicketsGetRequestG X
requestY `
)` a
{ 	
if 
( 
request 
. 
NumberOfTickets '
<( )
$num* +
)+ ,
throw- 2
new3 6
BadRequestException7 J
(J K
$strK f
)f g
;g h
if 
( 
request 
. 
Date 
< 
DateTime '
.' (
Now( +
)+ ,
throw- 2
new3 6
BadRequestException7 J
(J K
$strK Y
)Y Z
;Z [
var 
tickets 
= 
await 
_ticketRepository  1
.1 2
GetTicketsAsync2 A
(A B
requestB I
)I J
;J K
if 
( 
tickets 
. 
Count 
( 
) 
==  "
$num# $
)$ %
throw& +
new, /
NotFoundException0 A
(A B
$strB ]
)] ^
;^ _
return 
tickets 
; 
} 	
public!! 
async!! 
Task!! 
<!! 
TicketResponse!! (
>!!( )
UpdateTicketsAsync!!* <
(!!< =
UpdateTicketRequest!!= P
request!!Q X
)!!X Y
{"" 	
return## 
await## 
_ticketRepository## *
.##* +
UpdateTicketsAsync##+ =
(##= >
request##> E
)##E F
;##F G
}$$ 	
}%% 
}&& Ë 
àC:\Users\mirzace\Desktop\Projects\Junior Acceleration Program\JAP_Task1_v2\BackEnd\ScreenplayApp.Infrastructure\Services\TokenService.cs
	namespace 	
ScreenplayApp
 
. 
Infrastructure &
.& '
Services' /
{ 
public 

class 
TokenService 
: 
ITokenService  -
{ 
private 
readonly  
SymmetricSecurityKey -
_key. 2
;2 3
private 
readonly 
UserManager $
<$ %
AppUser% ,
>, -
_userManager. :
;: ;
public 
TokenService 
( 
IConfiguration *
configuration+ 8
,8 9
UserManager: E
<E F
AppUserF M
>M N
userManagerO Z
)Z [
{ 	
_key 
= 
new  
SymmetricSecurityKey +
(+ ,
Encoding, 4
.4 5
UTF85 9
.9 :
GetBytes: B
(B C
configurationC P
[P Q
$strQ [
][ \
)\ ]
)] ^
;^ _
_userManager 
= 
userManager &
;& '
} 	
public 
async 
Task 
< 
string  
>  !
CreateToken" -
(- .
AppUser. 5
user6 :
): ;
{ 	
var 
claims 
= 
new 
List !
<! "
Claim" '
>' (
{ 
new 
Claim 
( #
JwtRegisteredClaimNames 1
.1 2
NameId2 8
,8 9
user: >
.> ?
Id? A
.A B
ToStringB J
(J K
)K L
)L M
,M N
new 
Claim 
( #
JwtRegisteredClaimNames 1
.1 2

UniqueName2 <
,< =
user> B
.B C
UserNameC K
)K L
,L M
}   
;   
var"" 
roles"" 
="" 
await"" 
_userManager"" *
.""* +
GetRolesAsync""+ 8
(""8 9
user""9 =
)""= >
;""> ?
claims$$ 
.$$ 
AddRange$$ 
($$ 
roles$$ !
.$$! "
Select$$" (
($$( )
role$$) -
=>$$. 0
new$$1 4
Claim$$5 :
($$: ;

ClaimTypes$$; E
.$$E F
Role$$F J
,$$J K
role$$L P
)$$P Q
)$$Q R
)$$R S
;$$S T
var&& 
creds&& 
=&& 
new&& 
SigningCredentials&& .
(&&. /
_key&&/ 3
,&&3 4
SecurityAlgorithms&&5 G
.&&G H
HmacSha512Signature&&H [
)&&[ \
;&&\ ]
var(( 
tokenDescriptor(( 
=((  !
new((" %#
SecurityTokenDescriptor((& =
{)) 
Subject** 
=** 
new** 
ClaimsIdentity** ,
(**, -
claims**- 3
)**3 4
,**4 5
Expires++ 
=++ 
DateTime++ "
.++" #
Now++# &
.++& '
AddDays++' .
(++. /
$num++/ 0
)++0 1
,++1 2
SigningCredentials,, "
=,,# $
creds,,% *
}-- 
;-- 
var// 
tokenHandler// 
=// 
new// "#
JwtSecurityTokenHandler//# :
(//: ;
)//; <
;//< =
var11 
token11 
=11 
tokenHandler11 $
.11$ %
CreateToken11% 0
(110 1
tokenDescriptor111 @
)11@ A
;11A B
return33 
tokenHandler33 
.33  

WriteToken33  *
(33* +
token33+ 0
)330 1
;331 2
}44 	
}55 
}66 